"use strict";(self.webpackChunkpreclinic_angular=self.webpackChunkpreclinic_angular||[]).push([[592],{5485:(C,g,i)=>{i.d(g,{k:()=>Z});var e=i(5879),p=i(2137),_=i(3059),m=i(2220),v=i(2939),f=i(6814),d=i(9157),T=i(8525),a=i(3680),n=i(2296),u=i(7700),E=i(6223);function O(l,h){if(1&l&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&l){const t=h.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function D(l,h){if(1&l&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&l){const t=h.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function A(l,h){if(1&l&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&l){const t=h.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function P(l,h){if(1&l&&(e.ynx(0),e._uU(1),e.BQk()),2&l){const t=h.$implicit;e.xp6(1),e.hij(" ",t.placa," ")}}function U(l,h){if(1&l){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr")(2,"td",23)(3,"div",24)(4,"input",25),e.NdJ("click",function(){const o=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addUser(o))}),e.qZA()()(),e.TgZ(5,"td",23)(6,"div",24)(7,"input",26),e.NdJ("click",function(){const o=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addLider(o))}),e.qZA()()(),e.TgZ(8,"td",27),e._uU(9),e.qZA(),e.TgZ(10,"td"),e.YNc(11,P,2,1,"ng-container",18),e.qZA()(),e.BQk()}if(2&l){const t=h.$implicit,r=e.oxw();e.xp6(4),e.Q6J("checked",r.isCheck(t)),e.xp6(3),e.Q6J("disabled",r.islider(t)),e.xp6(2),e.AsE(" ",t.name," ",t.surname," "),e.xp6(2),e.Q6J("ngForOf",t.unidad_movil)}}const M=function(){return{standalone:!0}};let Z=(()=>{class l{constructor(t,r,s,o){this.cuadrillaService=t,this.configService=r,this.usuarioService=s,this._snackBar=o,this.tipobrigadas=[],this.contratistas=[],this.zonas=[],this.users=[],this.text_success="",this.text_validation="",this.user_selecteds=[],this.configService.cuadrillas().subscribe(c=>{this.tipobrigadas=c.tipobrigadas,this.zonas=c.zonas,this.contratistas=c.contratistas})}tecnicos(){this.user_selecteds=[],this.usuarioService.showUserZona(this.selectedZona).subscribe(t=>{console.log(t),this.users=t.data})}addUser(t,r=0){let s=null;console.log(t.unidad_movil.length),t.unidad_movil.length>0&&t.unidad_movil.forEach(c=>{s=c.id});const o=this.user_selecteds.findIndex(c=>c.user_id==t.id);-1!=o?this.user_selecteds.splice(o,1):this.user_selecteds.push({user_id:t.id,movil_id:s,is_lider:r}),console.log(this.user_selecteds)}addLider(t){if(-1!=this.user_selecteds.findIndex(s=>1==s.is_lider)){const s=this.user_selecteds.findIndex(o=>o.user_id==t.id&&1==o.is_lider);-1!=s?this.user_selecteds.splice(s,1,{user_id:this.user_selecteds[s].user_id,movil_id:this.user_selecteds[s].movil_id,is_lider:0}):console.log("no se puede agregar otro cliente")}else{const s=this.user_selecteds.findIndex(o=>o.user_id==t.id);-1!=s?this.user_selecteds.splice(s,1,{user_id:this.user_selecteds[s].user_id,movil_id:this.user_selecteds[s].movil_id,is_lider:1}):this.addUser(t,1),console.log("hace lo otro")}console.log(this.user_selecteds)}isCheck(t){return-1!=this.user_selecteds.findIndex(s=>s.user_id==t.id)}islider(t){return-1==this.user_selecteds.findIndex(s=>s.user_id==t.id&&1==s.is_lider)&&-1!=this.user_selecteds.findIndex(o=>1==o.is_lider)}snackBar(t){this._snackBar.open(t,"Cerrar",{horizontalPosition:"right",verticalPosition:"top",duration:3e3})}saveCuadrilla(){if(0==this.user_selecteds.length)return console.log(this.user_selecteds.length),void this.snackBar("No selecciono tecnico");const t=this.user_selecteds.findIndex(s=>1==s.is_lider);if(console.log(t),-1==t)return console.log(this.user_selecteds.length),void this.snackBar("No selecciono Lider");const r=new FormData;r.append("zona_id",this.selectedZona),r.append("tipo_brigada_id",this.selectedTipobrigadas),r.append("contratista_id",this.selectedContratistas),r.append("tecnicos",JSON.stringify(this.user_selecteds)),this.cuadrillaService.create(r).subscribe(s=>{console.log(s),403==s.message?this.snackBar("Falta ingresar datos"):(this.snackBar("Registro Exitoso"),this.selectedZona="",this.selectedTipobrigadas="",this.selectedContratistas="",this.user_selecteds=[],this.users=[],this.refresh())})}refresh(){this.configService.cuadrillas().subscribe(t=>{this.tipobrigadas=t.tipobrigadas,this.zonas=t.zonas,this.contratistas=t.contratistas})}static#e=this.\u0275fac=function(r){return new(r||l)(e.Y36(p.i),e.Y36(_.E),e.Y36(m.J),e.Y36(v.ux))};static#t=this.\u0275cmp=e.Xpm({type:l,selectors:[["app-add-cuadrilla"]],decls:61,vars:14,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-body"],[1,"col-12"],[1,"form-heading"],[1,"col-12","col-md-6","col-xl-6"],[1,"form-group","local-forms"],[1,"login-danger"],["placeholder","Seleccione Tipo",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Seleccione Contrata",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],["placeholder","Seleccione Zona",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange","selectionChange"],[1,"card-title"],[1,"table-responsive"],[1,"table","mb-0"],[4,"ngFor","ngForOf"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close","click"],[3,"value"],[2,"text-align","center !important"],[1,"form-check","check-tables"],["type","checkbox","name","checkbox",1,"form-check-input",3,"checked","click"],["type","checkbox","name","checkbox",1,"form-check-input",3,"disabled","click"],[2,"text-align","left !important"]],template:function(r,s){1&r&&(e.TgZ(0,"h2",0),e._uU(1,"Agregar Brigadas"),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"form")(8,"div",2)(9,"div",6)(10,"div",7)(11,"h4"),e._uU(12,"Registro de Cuadrilla"),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"mat-label"),e._uU(16,"Tipo Brigada "),e.TgZ(17,"span",10),e._uU(18,"*"),e.qZA()(),e.TgZ(19,"mat-select",11),e.NdJ("ngModelChange",function(c){return s.selectedTipobrigadas=c}),e.YNc(20,O,2,2,"mat-option",12),e.qZA()()(),e.TgZ(21,"div",8)(22,"div",9)(23,"mat-label"),e._uU(24,"Contrata "),e.TgZ(25,"span",10),e._uU(26,"*"),e.qZA()(),e.TgZ(27,"mat-select",13),e.NdJ("ngModelChange",function(c){return s.selectedContratistas=c}),e.YNc(28,D,2,2,"mat-option",12),e.qZA()()(),e.TgZ(29,"div",8)(30,"div",9)(31,"mat-label"),e._uU(32,"Zona "),e.TgZ(33,"span",10),e._uU(34,"*"),e.qZA()(),e.TgZ(35,"mat-select",14),e.NdJ("ngModelChange",function(c){return s.selectedZona=c})("selectionChange",function(){return s.tecnicos()}),e.YNc(36,A,2,2,"mat-option",12),e.qZA()()(),e.TgZ(37,"div",6)(38,"div",4)(39,"div",5)(40,"h4",15),e._uU(41,"Seleccione Tecnicos de Brigada"),e.qZA(),e.TgZ(42,"div",16)(43,"table",17)(44,"thead")(45,"tr")(46,"th"),e._uU(47,"*"),e.qZA(),e.TgZ(48,"th"),e._uU(49,"Lider"),e.qZA(),e.TgZ(50,"th"),e._uU(51,"Nombres"),e.qZA(),e.TgZ(52,"th"),e._uU(53,"UM"),e.qZA()()(),e.TgZ(54,"tbody"),e.YNc(55,U,12,5,"ng-container",18),e.qZA()()()()()()()()()()()()(),e.TgZ(56,"mat-dialog-actions",19)(57,"button",20),e._uU(58,"Cerrar"),e.qZA(),e.TgZ(59,"button",21),e.NdJ("click",function(){return s.saveCuadrilla()}),e._uU(60," Guardar "),e.qZA()()),2&r&&(e.xp6(19),e.Q6J("ngModel",s.selectedTipobrigadas)("ngModelOptions",e.DdM(11,M)),e.xp6(1),e.Q6J("ngForOf",s.tipobrigadas),e.xp6(7),e.Q6J("ngModel",s.selectedContratistas)("ngModelOptions",e.DdM(12,M)),e.xp6(1),e.Q6J("ngForOf",s.contratistas),e.xp6(7),e.Q6J("ngModel",s.selectedZona)("ngModelOptions",e.DdM(13,M)),e.xp6(1),e.Q6J("ngForOf",s.zonas),e.xp6(19),e.Q6J("ngForOf",s.users),e.xp6(4),e.Q6J("mat-dialog-close",!0))},dependencies:[f.sg,d.hX,T.gD,a.ey,n.lW,u.ZT,u.uh,u.xY,u.H8,E._Y,E.JJ,E.JL,E.On,E.F],styles:["mat-form-field[_ngcontent-%COMP%]{margin-right:12px}"]})}return l})()},2137:(C,g,i)=>{i.d(g,{i:()=>f});var e=i(2122),p=i(9368),_=i(5879),m=i(9862),v=i(3586);let f=(()=>{class d extends p.p{constructor(a,n){super(a,n,"brigadas"),this.http=a,this.authService=n}activa(){const a=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/activas`,{headers:a})}static#e=this.\u0275fac=function(n){return new(n||d)(_.LFG(m.eN),_.LFG(v.e))};static#t=this.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},1807:(C,g,i)=>{i.d(g,{P:()=>f});var e=i(2122),p=i(9368),_=i(5879),m=i(9862),v=i(3586);let f=(()=>{class d extends p.p{constructor(a,n){super(a,n,"sites"),this.http=a,this.authService=n}showProvinciasDep(a){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/provincias/depto/${a}`,{headers:n})}showDistritoProv(a){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/distritos/provincia/${a}`,{headers:n})}autocomplete(a=""){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/autocomplete?search=${a}`,{headers:n})}static#e=this.\u0275fac=function(n){return new(n||d)(_.LFG(m.eN),_.LFG(v.e))};static#t=this.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},2220:(C,g,i)=>{i.d(g,{J:()=>f});var e=i(2122),p=i(9368),_=i(5879),m=i(9862),v=i(3586);let f=(()=>{class d extends p.p{constructor(a,n){super(a,n,"usuarios"),this.http=a,this.authService=n}showUserZona(a){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/tecnicos/zona/${a}`,{headers:n})}showResponsables(){const a=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/responsables/zona`,{headers:a})}static#e=this.\u0275fac=function(n){return new(n||d)(_.LFG(m.eN),_.LFG(v.e))};static#t=this.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);