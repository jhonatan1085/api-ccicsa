"use strict";(self.webpackChunkpreclinic_angular=self.webpackChunkpreclinic_angular||[]).push([[592],{5485:(C,p,i)=>{i.d(p,{k:()=>L});var e=i(5879),u=i(7700),_=i(2137),m=i(3059),v=i(2220),f=i(2939),d=i(3432),D=i(6814),o=i(9157),n=i(8525),h=i(3680),O=i(2296),E=i(6223);function A(l,g){if(1&l&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&l){const t=g.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function U(l,g){if(1&l&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&l){const t=g.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function Z(l,g){if(1&l&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&l){const t=g.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.nombre," ")}}function P(l,g){if(1&l&&(e.ynx(0),e._uU(1),e.BQk()),2&l){const t=g.$implicit;e.xp6(1),e.hij(" ",t.placa," ")}}function I(l,g){if(1&l){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr")(2,"td",25)(3,"div",26)(4,"input",27),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addUser(a))}),e.qZA()()(),e.TgZ(5,"td",25)(6,"div",26)(7,"input",28),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.addLider(a))}),e.qZA()()(),e.TgZ(8,"td",29),e._uU(9),e.qZA(),e.TgZ(10,"td"),e.YNc(11,P,2,1,"ng-container",20),e.qZA()(),e.BQk()}if(2&l){const t=g.$implicit,r=e.oxw();e.xp6(4),e.Q6J("checked",r.isCheck(t)),e.xp6(3),e.Q6J("disabled",r.islider(t)),e.xp6(2),e.AsE(" ",t.name," ",t.surname," "),e.xp6(2),e.Q6J("ngForOf",t.unidad_movil)}}const M=function(){return{standalone:!0}};let L=(()=>{class l{constructor(t,r,s,a,c,x){this.dialogRef=t,this.cuadrillaService=r,this.configService=s,this.usuarioService=a,this._snackBar=c,this.utilities=x,this.tipobrigadas=[],this.contratistas=[],this.zonas=[],this.users=[],this.text_success="",this.text_validation="",this.user_selecteds=[],this.configService.cuadrillas().subscribe(T=>{this.tipobrigadas=T.tipobrigadas,this.zonas=T.zonas,this.contratistas=T.contratistas})}tecnicos(){this.user_selecteds=[],this.usuarioService.showUserZona(this.selectedZona).subscribe(t=>{console.log(t),this.users=t.data})}addUser(t,r=0){let s=null;console.log(t.unidad_movil.length),t.unidad_movil.length>0&&t.unidad_movil.forEach(c=>{s=c.id});const a=this.user_selecteds.findIndex(c=>c.user_id==t.id);-1!=a?this.user_selecteds.splice(a,1):this.user_selecteds.push({user_id:t.id,movil_id:s,is_lider:r}),console.log(this.user_selecteds)}addLider(t){if(-1!=this.user_selecteds.findIndex(s=>1==s.is_lider)){const s=this.user_selecteds.findIndex(a=>a.user_id==t.id&&1==a.is_lider);-1!=s?this.user_selecteds.splice(s,1,{user_id:this.user_selecteds[s].user_id,movil_id:this.user_selecteds[s].movil_id,is_lider:0}):console.log("no se puede agregar otro cliente")}else{const s=this.user_selecteds.findIndex(a=>a.user_id==t.id);-1!=s?this.user_selecteds.splice(s,1,{user_id:this.user_selecteds[s].user_id,movil_id:this.user_selecteds[s].movil_id,is_lider:1}):this.addUser(t,1),console.log("hace lo otro")}console.log(this.user_selecteds)}isCheck(t){return-1!=this.user_selecteds.findIndex(s=>s.user_id==t.id)}islider(t){return-1==this.user_selecteds.findIndex(s=>s.user_id==t.id&&1==s.is_lider)&&-1!=this.user_selecteds.findIndex(a=>1==a.is_lider)}saveCuadrilla(){if(0==this.user_selecteds.length)return console.log(this.user_selecteds.length),void this.utilities.snackBar("No selecciono tecnico");const t=this.user_selecteds.findIndex(s=>1==s.is_lider);if(console.log(t),-1==t)return console.log(this.user_selecteds.length),void this.utilities.snackBar("No selecciono Lider");const r=new FormData;r.append("zona_id",this.selectedZona),r.append("tipo_brigada_id",this.selectedTipobrigadas),r.append("contratista_id",this.selectedContratistas),r.append("nombre",this.nombre),r.append("tecnicos",JSON.stringify(this.user_selecteds)),this.cuadrillaService.create(r).subscribe(s=>{console.log(s),403==s.message?this.utilities.snackBar("Falta ingresar datos"):(this.utilities.snackBar("Registro Exitoso"),this.dialogRef.close(),this.selectedZona="",this.selectedTipobrigadas="",this.selectedContratistas="",this.nombre="",this.user_selecteds=[],this.users=[],this.refresh())})}refresh(){this.configService.cuadrillas().subscribe(t=>{this.tipobrigadas=t.tipobrigadas,this.zonas=t.zonas,this.contratistas=t.contratistas})}static#e=this.\u0275fac=function(r){return new(r||l)(e.Y36(u.so),e.Y36(_.i),e.Y36(m.E),e.Y36(v.J),e.Y36(f.ux),e.Y36(d.e))};static#t=this.\u0275cmp=e.Xpm({type:l,selectors:[["app-add-cuadrilla"]],decls:66,vars:14,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-body"],[1,"col-12"],[1,"form-heading"],[1,"col-12","col-md-6","col-xl-6"],[1,"form-group","local-forms"],[1,"login-danger"],["placeholder","Seleccione Tipo",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Seleccione Contrata",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],["placeholder","Seleccione Zona",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange","selectionChange"],["for","nombre"],["name","nombre","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"card-title"],[1,"table-responsive"],[1,"table","mb-0"],[4,"ngFor","ngForOf"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","cdkFocusInitial","",3,"click"],[3,"value"],[2,"text-align","center !important"],[1,"form-check","check-tables"],["type","checkbox","name","checkbox",1,"form-check-input",3,"checked","click"],["type","checkbox","name","checkbox",1,"form-check-input",3,"disabled","click"],[2,"text-align","left !important"]],template:function(r,s){1&r&&(e.TgZ(0,"h2",0),e._uU(1,"Agregar Brigadas"),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"form")(8,"div",2)(9,"div",6)(10,"div",7)(11,"h4"),e._uU(12,"Registro de Cuadrilla"),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"mat-label"),e._uU(16,"Tipo Brigada "),e.TgZ(17,"span",10),e._uU(18,"*"),e.qZA()(),e.TgZ(19,"mat-select",11),e.NdJ("ngModelChange",function(c){return s.selectedTipobrigadas=c}),e.YNc(20,A,2,2,"mat-option",12),e.qZA()()(),e.TgZ(21,"div",8)(22,"div",9)(23,"mat-label"),e._uU(24,"Contrata "),e.TgZ(25,"span",10),e._uU(26,"*"),e.qZA()(),e.TgZ(27,"mat-select",13),e.NdJ("ngModelChange",function(c){return s.selectedContratistas=c}),e.YNc(28,U,2,2,"mat-option",12),e.qZA()()(),e.TgZ(29,"div",8)(30,"div",9)(31,"mat-label"),e._uU(32,"Base "),e.TgZ(33,"span",10),e._uU(34,"*"),e.qZA()(),e.TgZ(35,"mat-select",14),e.NdJ("ngModelChange",function(c){return s.selectedZona=c})("selectionChange",function(){return s.tecnicos()}),e.YNc(36,Z,2,2,"mat-option",12),e.qZA()()(),e.TgZ(37,"div",8)(38,"div",9)(39,"mat-label",15),e._uU(40,"Nombre "),e.qZA(),e.TgZ(41,"input",16),e.NdJ("ngModelChange",function(c){return s.nombre=c}),e.qZA()()(),e.TgZ(42,"div",6)(43,"div",4)(44,"div",5)(45,"h4",17),e._uU(46,"Seleccione Tecnicos de Brigada"),e.qZA(),e.TgZ(47,"div",18)(48,"table",19)(49,"thead")(50,"tr")(51,"th"),e._uU(52,"*"),e.qZA(),e.TgZ(53,"th"),e._uU(54,"Lider"),e.qZA(),e.TgZ(55,"th"),e._uU(56,"Nombres"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"UM"),e.qZA()()(),e.TgZ(59,"tbody"),e.YNc(60,I,12,5,"ng-container",20),e.qZA()()()()()()()()()()()()(),e.TgZ(61,"mat-dialog-actions",21)(62,"button",22),e._uU(63,"Cerrar"),e.qZA(),e.TgZ(64,"button",23),e.NdJ("click",function(){return s.saveCuadrilla()}),e._uU(65," Guardar "),e.qZA()()),2&r&&(e.xp6(19),e.Q6J("ngModel",s.selectedTipobrigadas)("ngModelOptions",e.DdM(11,M)),e.xp6(1),e.Q6J("ngForOf",s.tipobrigadas),e.xp6(7),e.Q6J("ngModel",s.selectedContratistas)("ngModelOptions",e.DdM(12,M)),e.xp6(1),e.Q6J("ngForOf",s.contratistas),e.xp6(7),e.Q6J("ngModel",s.selectedZona)("ngModelOptions",e.DdM(13,M)),e.xp6(1),e.Q6J("ngForOf",s.zonas),e.xp6(5),e.Q6J("ngModel",s.nombre),e.xp6(19),e.Q6J("ngForOf",s.users))},dependencies:[D.sg,o.hX,n.gD,h.ey,O.lW,u.ZT,u.uh,u.xY,u.H8,E._Y,E.Fj,E.JJ,E.JL,E.On,E.F],styles:["mat-form-field[_ngcontent-%COMP%]{margin-right:12px}"]})}return l})()},2137:(C,p,i)=>{i.d(p,{i:()=>f});var e=i(2122),u=i(9368),_=i(5879),m=i(9862),v=i(3586);let f=(()=>{class d extends u.p{constructor(o,n){super(o,n,"brigadas"),this.http=o,this.authService=n}activa(){const o=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/activas`,{headers:o})}static#e=this.\u0275fac=function(n){return new(n||d)(_.LFG(m.eN),_.LFG(v.e))};static#t=this.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},1807:(C,p,i)=>{i.d(p,{P:()=>f});var e=i(2122),u=i(9368),_=i(5879),m=i(9862),v=i(3586);let f=(()=>{class d extends u.p{constructor(o,n){super(o,n,"sites"),this.http=o,this.authService=n}showProvinciasDep(o){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/provincias/depto/${o}`,{headers:n})}showDistritoProv(o){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/distritos/provincia/${o}`,{headers:n})}showMunicipalidadDistrito(o){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/municipalidad/distrito/${o}`,{headers:n})}autocomplete(o=""){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/autocomplete?search=${o}`,{headers:n})}static#e=this.\u0275fac=function(n){return new(n||d)(_.LFG(m.eN),_.LFG(v.e))};static#t=this.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},2220:(C,p,i)=>{i.d(p,{J:()=>f});var e=i(2122),u=i(9368),_=i(5879),m=i(9862),v=i(3586);let f=(()=>{class d extends u.p{constructor(o,n){super(o,n,"usuarios"),this.http=o,this.authService=n}showUserZona(o){const n=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/tecnicos/zona/${o}`,{headers:n})}showResponsables(){const o=this.getHeaders();return this.http.get(`${e.$g}/${this.endpoint}/responsables/zona`,{headers:o})}static#e=this.\u0275fac=function(n){return new(n||d)(_.LFG(m.eN),_.LFG(v.e))};static#t=this.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);