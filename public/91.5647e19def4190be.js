(self.webpackChunkpreclinic_angular=self.webpackChunkpreclinic_angular||[]).push([[91],{4091:(Jn,cn,xe)=>{"use strict";xe.r(cn),xe.d(cn,{BitacorasModule:()=>vw});var Je=xe(6814),Ir=xe(1303),o=xe(5879);let Ut=(()=>{class e{static#e=this.\u0275fac=function(a){return new(a||e)};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-bitacoras"]],decls:1,vars:0,template:function(a,n){1&a&&o._UZ(0,"router-outlet")},dependencies:[Ir.lC]})}return e})();var ue=xe(6223),Zt=xe(5313),Gr=xe(2181),fn=xe(4664),oa=xe(7921),ye=xe(7398),De=xe(5485),Lr=xe(3059),Ce=xe(2893),yr=xe(1807),Kn=xe(2137),ln=xe(2220),At=xe(2939),Oe=xe(7700),dt=xe(2296);function Ht(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"button",2),o.NdJ("click",function(){const i=o.CHM(r).$implicit;return o.KtG(null==i.action?null:i.action())}),o._uU(1),o.qZA()}if(2&e){const r=t.$implicit;o.Q6J("color",r.color),o.xp6(1),o.hij(" ",r.text," ")}}let sf=(()=>{class e{constructor(r){this.data=r}static#e=this.\u0275fac=function(a){return new(a||e)(o.Y36(Oe.WI))};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-alert"]],decls:6,vars:3,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close","",3,"color","click",4,"ngFor","ngForOf"],["mat-button","","mat-dialog-close","",3,"color","click"]],template:function(a,n){1&a&&(o.TgZ(0,"h2",0),o._uU(1),o.qZA(),o.TgZ(2,"mat-dialog-content"),o._uU(3),o.qZA(),o.TgZ(4,"mat-dialog-actions"),o.YNc(5,Ht,2,2,"button",1),o.qZA()),2&a&&(o.xp6(1),o.Oqu(n.data.title),o.xp6(2),o.hij(" ",n.data.message,"\n"),o.xp6(2),o.Q6J("ngForOf",n.data.buttons))},dependencies:[Je.sg,dt.lW,Oe.ZT,Oe.uh,Oe.xY,Oe.H8]})}return e})(),of=(()=>{class e{constructor(r){this.dialog=r}alert(r){this.dialog.open(sf,{data:r})}static#e=this.\u0275fac=function(a){return new(a||e)(o.LFG(Oe.uw))};static#r=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),un=(()=>{class e{constructor(){}calcularDiferenciaTiempo(r,a){return new Date(a).valueOf()-new Date(r).valueOf()}convierteHoras(r){const a=Math.floor(r/1e3/60/60),n=r/1e3/60-60*a;return a.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")}updateTotalDemoras(r){let a=0;for(let n=0;n<r.length;n++){const i=r[n];a+=new Date(i.fecha_fin).valueOf()-new Date(i.fecha_inicio).valueOf()}return a}TotalSla(r){let a=0;for(let s=0;s<r.length;s++){const c=r[s];a+=new Date(c.fecha_fin).valueOf()-new Date(c.fecha_inicio).valueOf()}const n=Math.floor(a/1e3/60/60),i=a/1e3/60-60*n;return n.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")}getLocalDateTime(){const r=new Date;return`${r.getFullYear()}-${(r.getMonth()+1).toString().padStart(2,"0")}-${r.getDate().toString().padStart(2,"0")}T${r.getHours().toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")}`}fechaEjecucionMayorValidator(r,a){return n=>{const i=n.get(r)?.value,s=n.get(a)?.value;return i&&s&&s<i?{fechaEjecucionMenor:!0}:null}}static#e=this.\u0275fac=function(a){return new(a||e)};static#r=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ba=xe(7816),ws=xe(9157),Ts=xe(8525),ks=xe(3680),ca=xe(3305),Es=xe(6381),bs=xe(7466),cf=xe(2599);function ff(e,t){if(1&e&&(o.TgZ(0,"mat-option",85),o._uU(1),o.qZA()),2&e){const r=t.$implicit;o.Q6J("value",r.id),o.xp6(1),o.hij(" ",r.nombre," ")}}function lf(e,t){if(1&e&&(o.TgZ(0,"mat-option",85),o._uU(1),o.qZA()),2&e){const r=t.$implicit;o.Q6J("value",r.id),o.xp6(1),o.hij(" ",r.nombre," ")}}function uf(e,t){if(1&e&&(o.TgZ(0,"mat-option",85),o._uU(1),o.qZA()),2&e){const r=t.$implicit;o.Q6J("value",r.id),o.xp6(1),o.hij(" ",r.nombre," ")}}function hf(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"mat-option",86),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.onSetSite(i))}),o._uU(1),o.qZA()}if(2&e){const r=t.$implicit;o.Q6J("value",r),o.xp6(1),o.AsE(" ",r.codigo," - ",r.nombre," ")}}function df(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"button",91),o.NdJ("click",function(){o.CHM(r);const n=o.oxw().$implicit,i=o.oxw();return o.KtG(i.addBrigada(n))}),o._UZ(1,"i",65),o.qZA()}}function xf(e,t){if(1&e){const r=o.EpF();o.ynx(0),o.TgZ(1,"tr")(2,"td"),o._uU(3),o.qZA(),o.TgZ(4,"td"),o._uU(5),o.qZA(),o.TgZ(6,"td"),o._uU(7),o.qZA(),o.TgZ(8,"td"),o._uU(9),o.qZA(),o.TgZ(10,"td"),o._uU(11),o.qZA(),o.TgZ(12,"td")(13,"div",87)(14,"button",88),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.showSegment(i))}),o._UZ(15,"i",89),o.qZA(),o.YNc(16,df,2,0,"button",90),o.qZA()()(),o.BQk()}if(2&e){const r=t.$implicit,a=o.oxw();o.xp6(3),o.Oqu(r.nombre),o.xp6(2),o.Oqu(r.tipo_brigada.nombre),o.xp6(2),o.Oqu(r.contratista.nombre),o.xp6(2),o.Oqu(r.zona.nombre),o.xp6(2),o.Oqu(a.countTecnicos(r)),o.xp6(5),o.Q6J("ngIf",a.searchadd(r))}}function pf(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"li",93),o.NdJ("click",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage-2))})("keyup.enter",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage-2))}),o.TgZ(1,"a",94),o._uU(2," ... "),o.qZA()()}if(2&e){const r=o.oxw(2);o.Q6J("hidden",1===r.currentPage)}}function mf(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"li",93),o.NdJ("click",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage+2))})("keyup.enter",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage+2))}),o.TgZ(1,"a",94),o._uU(2," ... "),o.qZA()()}if(2&e){const r=o.oxw(2);o.Q6J("hidden",r.currentPage>=r.pageNumberArray[r.pageNumberArray.length-2]||r.totalData<r.serialNumberArray[r.serialNumberArray.length-1])}}function _f(e,t){if(1&e){const r=o.EpF();o.ynx(0),o.TgZ(1,"li",73)(2,"a",75),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.moveToPage(i))}),o._uU(3),o.qZA()(),o.YNc(4,pf,3,1,"li",92),o.YNc(5,mf,3,1,"li",92),o.BQk()}if(2&e){const r=t.$implicit,a=t.index,n=o.oxw();o.xp6(1),o.ekj("active",r===n.currentPage),o.Q6J("ngClass",n.pageNumberArray[n.currentPage-2]>r&&1!==r&&n.pageNumberArray.length>6||n.pageNumberArray[n.currentPage]<r&&1!==r&&n.pageNumberArray.length>6&&n.pageNumberArray.length!==r?"hide-page-no":"show-page-no"),o.xp6(2),o.hij(" ",r," "),o.xp6(1),o.Q6J("ngIf",0===a&&n.pageNumberArray.length>6&&n.currentPage>2),o.xp6(1),o.Q6J("ngIf",a===n.pageNumberArray.length-2&&n.pageNumberArray.length>6)}}function gf(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.hij(" ",r.unidad_movil.placa," ")}}function vf(e,t){if(1&e&&(o.ynx(0),o.TgZ(1,"tr")(2,"td"),o._uU(3),o.qZA(),o.TgZ(4,"td"),o.YNc(5,gf,2,1,"div",95),o.qZA()(),o.BQk()),2&e){const r=t.$implicit;o.xp6(3),o.hij(" ",r.user.nombre," "),o.xp6(2),o.Q6J("ngIf",r.unidad_movil)}}function wf(e,t){if(1&e&&(o.TgZ(0,"div",15)(1,"div",77)(2,"div",78)(3,"div",62)(4,"table",63)(5,"thead")(6,"tr")(7,"th"),o._uU(8,"TECNICO"),o.qZA(),o.TgZ(9,"th"),o._uU(10,"UM"),o.qZA()()(),o.TgZ(11,"tbody"),o.YNc(12,vf,6,2,"ng-container",66),o.qZA()()()()()()),2&e){const r=o.oxw();o.xp6(12),o.Q6J("ngForOf",r.brigadaSelected.user_movil)}}function Tf(e,t){if(1&e){const r=o.EpF();o.ynx(0),o.TgZ(1,"tr")(2,"td"),o._uU(3),o.qZA(),o.TgZ(4,"td"),o._uU(5),o.qZA(),o.TgZ(6,"td")(7,"div",87)(8,"button",96),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.addBrigada(i))}),o._UZ(9,"i",97),o.qZA()()()(),o.BQk()}if(2&e){const r=t.$implicit;o.xp6(3),o.Oqu(r.zona),o.xp6(2),o.Oqu(r.nombre)}}function kf(e,t){if(1&e&&(o.TgZ(0,"mat-radio-button",98),o._uU(1),o.qZA()),2&e){const r=t.$implicit;o.Q6J("value",r.id),o.xp6(1),o.AsE("",r.name," ",r.surname," ")}}function Ef(e,t){if(1&e&&(o.TgZ(0,"mat-radio-button",98),o._uU(1),o.qZA()),2&e){const r=t.$implicit;o.Q6J("value",r.id),o.xp6(1),o.AsE("",r.name," ",r.surname," ")}}function bf(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"div",99)(1,"button",100),o.NdJ("click",function(){o.CHM(r);const n=o.oxw();return o.KtG(n.onDelete())}),o._uU(2," Eliminar "),o.qZA()()}}const As=function(e){return{disabled:e}};let Qn=(()=>{class e{constructor(r,a,n,i,s,c,f,l,u,h,p,m,_){this.configService=r,this.bitacoraService=a,this.siteService=n,this.brigadasService=i,this.usuarioService=s,this._snackBar=c,this.router=f,this.activateRoute=l,this.fb=u,this.dialog=h,this.alertService=p,this.time_utils=m,this.utilities=_,this.brigadas=[],this.showFilter=!1,this.searchDataValue="",this.lastIndex=0,this.pageSize=5,this.totalData=0,this.skip=0,this.limit=this.pageSize,this.pageIndex=0,this.serialNumberArray=[],this.currentPage=1,this.pageNumberArray=[],this.pageSelection=[],this.totalPages=0,this.brigadasGeneral=[],this.responsables_cicsa=[],this.responsables_claro=[],this.panelOpenState=!1,this.bitacora={tipo_averia:{},red:{},serv:{},resp_cicsa:{},resp_claro:{}},this.tipo_Averia=[],this.red=[],this.serv=[],this.siteControl=new ue.NI,this.step=0;const x=this.time_utils.getLocalDateTime();this.datosForm=this.fb.group({nombre:[null,ue.kI.required],enlace_plano_site:[],fecha_inicial:[x,ue.kI.required],fecha_ejecucion:[x],sot:[],fecha_sot:[x],incidencia:[],latitud:[null],longitud:[null],distancia:[],tipo_averia_id:[null,ue.kI.required],red_id:[null,ue.kI.required],serv_id:[null,ue.kI.required],nro_tas:[],nro_crq:[],afect_servicio:[!1],afect_masiva:[!1]},{validators:[this.time_utils.fechaEjecucionMayorValidator("fecha_inicial","fecha_ejecucion"),this.utilities.validateCoordinates.bind(this.utilities)]}),this.siteForm=this.fb.group({site_id:[null,ue.kI.required],cliente:[]}),this.brigadasForm=this.fb.group({brigadas:this.fb.array([],ue.kI.required)}),this.responsablesForm=this.fb.group({resp_cicsa_id:[null,ue.kI.required],resp_claro_id:[null,ue.kI.required]})}ngOnInit(){this.getBitacoraFromParams(),this.getConfigBitacora(),this.getSites(),this.getTableData(),this.dataResponsables()}getBitacoraFromParams(){this.activateRoute.params.pipe((0,Gr.h)(r=>r.id),(0,fn.w)(r=>this.bitacoraService.read(r.id))).subscribe(r=>{console.log(r),this.bitacora=r,this.datosForm.patchValue({...this.bitacora,tipo_averia_id:r.tipo_averia.id,red_id:r.red.id,serv_id:r.serv.id}),this.siteForm.patchValue({site_id:r.site.id,cliente:r.cliente}),this.brigadasForm.reset(),this.bitacora.brigadas.forEach(a=>{this.addBrigada(a)}),this.responsablesForm.patchValue({resp_cicsa_id:this.bitacora.resp_cicsa.id,resp_claro_id:this.bitacora.resp_claro.id}),this.getSites()})}getConfigBitacora(){this.configService.bitacoras().subscribe(r=>{this.tipo_Averia=r.tipoaveria,this.red=r.red,this.serv=r.serv})}getSites(){this.siteService.autocomplete().subscribe(r=>{console.log(r.data),this.setSites(r.data)})}getTableData(){this.brigadas=[],this.serialNumberArray=[],this.brigadasService.activa().subscribe(r=>{this.totalData=r.data.length,this.brigadasGeneral=r.data,this.getTableDataGeneral()})}getTableDataGeneral(){this.brigadas=[],this.serialNumberArray=[],this.brigadasGeneral.map((r,a)=>{const n=a+1;a>=this.skip&&n<=this.limit&&(this.brigadas.push(r),this.serialNumberArray.push(n))}),this.dataSource=new Zt.by(this.brigadas),this.calculateTotalPages(this.totalData,this.pageSize)}sortData(r){const a=this.brigadas.slice();this.brigadas=r.active&&""!==r.direction?a.sort((n,i)=>(n[r.active]<i[r.active]?-1:1)*("asc"===r.direction?1:-1)):a}getMoreData(r){"next"==r?(this.currentPage++,this.pageIndex=this.currentPage-1,this.limit+=this.pageSize,this.skip=this.pageSize*this.pageIndex,this.getTableDataGeneral()):"previous"==r&&(this.currentPage--,this.pageIndex=this.currentPage-1,this.limit-=this.pageSize,this.skip=this.pageSize*this.pageIndex,this.getTableDataGeneral())}moveToPage(r){this.currentPage=r,this.skip=this.pageSelection[r-1].skip,this.limit=this.pageSelection[r-1].limit,r>this.currentPage?this.pageIndex=r-1:r<this.currentPage&&(this.pageIndex=r+1),this.getTableDataGeneral()}PageSize(){this.pageSelection=[],this.limit=this.pageSize,this.skip=0,this.currentPage=1,this.searchDataValue="",this.getTableData()}calculateTotalPages(r,a){this.pageNumberArray=[],this.totalPages=r/a,this.totalPages%1!=0&&(this.totalPages=Math.trunc(this.totalPages+1));for(var n=1;n<=this.totalPages;n++){const i=a*n,s=i-a;this.pageNumberArray.push(n),this.pageSelection.push({skip:s,limit:i})}}countTecnicos(r){return r.user_movil.length}showSegment(r){this.brigadaSelected=r}addBrigada(r){const a=this.brigadasForm.get("brigadas"),i=a.value.findIndex(s=>s.id==r.id);-1!=i?a.removeAt(i):a.push(this.fb.group({id:[r.id],nombre:[r.nombre],zona:[r.zona.nombre]}))}searchadd(r){return-1==this.brigadasForm.value.brigadas.findIndex(i=>i.id==r.id)}setSites(r){this.sites=r,this.filteredSites=this.siteControl.valueChanges.pipe((0,oa.O)(""),(0,ye.U)(a=>a.length>=1?this._filter(a):[])),this.bitacora&&(this.site=this.sites.find(a=>a.id===this.bitacora.site.id),this.site&&this.onSetSite(this.site))}_filter(r){const a=r.toLowerCase();return this.sites.filter(n=>n.nombre.toLowerCase().includes(a))}displayFn(r){return r?r.nombre:void 0}onSetSite(r){this.bitacora&&(this.siteForm.patchValue({site_id:r.id}),this.bitacora.site=r,this.site=r)}dataResponsables(){this.usuarioService.showResponsables().subscribe(r=>{console.log(r),this.responsables_cicsa=r.cicsa,this.responsables_claro=r.claro})}snackBar(r){this._snackBar.open(r,"Cerrar",{horizontalPosition:"right",verticalPosition:"top",duration:3e3})}saveBitacora(){if(!this.bitacora)return void console.error("No Bitacora was created");console.log(this.bitacora),console.log(this.datosForm.value);const r={...this.bitacora,...this.datosForm.value,...this.siteForm.value,...this.brigadasForm.value,...this.responsablesForm.value};console.log(r),this.bitacora.id?this.bitacoraService.update(this.bitacora.id,r).subscribe(a=>{console.log(a),403==a.message?this.snackBar("Falta ingresar datos"):(this.snackBar("Registro Exitoso"),this.router.navigate(["/bitacoras/list-bitacora"]))}):this.bitacoraService.create(r).subscribe(a=>{console.log(a),403==a.message?this.snackBar("Falta ingresar datos"):(this.snackBar("Registro Exitoso"),this.router.navigate(["/bitacoras/list-bitacora"]))})}onAddBrigada(){this.dialog.open(De.k).afterClosed().subscribe(()=>{this.getTableData()})}onDelete(){this.alertService.alert({title:"Borrar Bitacora",message:"\xbfEst\xe1s seguro de borrar la bitacora?",buttons:[{text:"Cancelar"},{text:"Borrar",color:"warn",action:()=>{this.bitacoraService.delete(this.bitacora.id).subscribe(()=>{this.snackBar("Bitacora Borrada"),this.router.navigate(["bitacoras/list-bitacora"])})}}]})}setStep(r){this.step=r}nextStep(){this.step++}prevStep(){this.step--}static#e=this.\u0275fac=function(a){return new(a||e)(o.Y36(Lr.E),o.Y36(Ce.k),o.Y36(yr.P),o.Y36(Kn.i),o.Y36(ln.J),o.Y36(At.ux),o.Y36(Ir.F0),o.Y36(Ir.gz),o.Y36(ue.qu),o.Y36(Oe.uw),o.Y36(of),o.Y36(un),o.Y36(ba.e))};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-add-bitacoras"]],decls:301,vars:52,consts:[[1,"page-wrapper"],[1,"content"],[1,"page-header"],[1,"row"],[1,"col-sm-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"feather","icon-chevron-right"],[1,"breadcrumb-item","active"],[1,"card"],[1,"card-body"],[1,"example-headers-align"],["hideToggle","",3,"expanded","opened"],[1,"row","align-items-center",3,"formGroup"],[1,"col-12"],[1,"form-heading"],[1,"col-12","col-md-6","col-xl-3"],[1,"form-group","local-forms"],["for","nombre"],[1,"login-danger"],["formControlName","nombre","name","nombre","type","text",1,"form-control"],["formControlName","enlace_plano_site","name","enlace_plano_site","type","text",1,"form-control"],[1,"col-12","col-md-6","col-xl-2"],["for","fecha_inicial"],["type","datetime-local","formControlName","fecha_inicial","name","fecha_inicial",1,"form-control"],["for","fecha_ejecucion"],["type","datetime-local","formControlName","fecha_ejecucion","name","fecha_ejecucion",1,"form-control"],["for","nro_incidencia"],["formControlName","incidencia","name","nro_incidencia","type","text",1,"form-control"],["for","nro_sot"],["formControlName","sot","name","nro_sot","type","text",1,"form-control"],["for","fecha_sot"],["type","datetime-local","formControlName","fecha_sot","name","fecha_sot",1,"form-control"],["formControlName","tipo_averia_id","placeholder","Selec. Tipo Averia",1,"form-control","select"],[3,"value",4,"ngFor","ngForOf"],["for","latitud"],["formControlName","latitud","name","latitud","type","text",1,"form-control"],["for","longitud"],["formControlName","longitud","name","longitud","type","text",1,"form-control"],["for","distancia"],["formControlName","distancia","name","distancia","type","number",1,"form-control"],["for","selectedRed"],["formControlName","red_id","placeholder","Selec. Red1",1,"form-control","select"],["formControlName","serv_id","placeholder","Selec. Serv1",1,"form-control","select"],["for","nro_tas"],["formControlName","nro_tas","name","nro_tas","type","text",1,"form-control"],["for","nro_crq"],["formControlName","nro_crq","name","nro_crq","type","text",1,"form-control"],[1,""],["formControlName","afect_servicio"],["formControlName","afect_masiva"],["mat-button","","color","primary",3,"disabled","click"],["type","text",1,"form-control",3,"formControl","matAutocomplete"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],[1,"form-control",3,"value","disabled"],["for","cliente"],["formControlName","cliente","name","cliente","type","text",1,"form-control"],["mat-button","","color","warn",3,"click"],[1,"row","align-items-center"],[1,"table-responsive"],[1,"table","mb-0"],[1,"ml-auto","check-point","status-blue","me-1",3,"click"],[1,"feather","icon-plus"],[4,"ngFor","ngForOf"],[1,"table_footer"],[1,"col-sm-12","col-md-5"],[1,"dataTables_info"],[1,"col-sm-12","col-md-7"],[1,"pagination_section"],[1,"pagination"],[1,"page-item",3,"ngClass"],["href","javascript:void(0);","tabindex","-1",1,"page-link",3,"click"],["href","javascript:void(0);",1,"page-link",3,"click"],["class","col-12",4,"ngIf"],[1,"card-box"],[1,"card-block"],[1,"card-title"],[2,"text-align","center !important"],["aria-labelledby","example-radio-group-label","formControlName","resp_cicsa_id",1,"example-radio-group"],["class","example-radio-button",3,"value",4,"ngFor","ngForOf"],["aria-labelledby","example-radio-group-label","formControlName","resp_claro_id",1,"example-radio-group"],["class","col-12 d-flex",4,"ngIf"],[3,"value"],[3,"value","click"],[1,"add-group"],[1,"check-point","status-blue","me-1",3,"click"],[1,"feather","icon-search"],["class","check-point status-blue",3,"click",4,"ngIf"],[1,"check-point","status-blue",3,"click"],["class","page-item","tabindex","0",3,"hidden","click","keyup.enter",4,"ngIf"],["tabindex","0",1,"page-item",3,"hidden","click","keyup.enter"],["href","javascript:void(0);",1,"page-link"],[4,"ngIf"],[1,"check-point","status-red",3,"click"],[1,"feather","icon-x"],[1,"example-radio-button",3,"value"],[1,"col-12","d-flex"],["mat-button","","color","warn",1,"ms-auto","mt-2",3,"click"]],template:function(a,n){if(1&a&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),o._uU(8,"Bitacoras "),o.qZA()(),o.TgZ(9,"li",6),o._UZ(10,"i",8),o.qZA(),o.TgZ(11,"li",9),o._uU(12,"Agregar Bitacora"),o.qZA()()()()(),o.TgZ(13,"div",3)(14,"div",4)(15,"div",10)(16,"div",11)(17,"form")(18,"mat-accordion",12)(19,"mat-expansion-panel",13),o.NdJ("opened",function(){return n.setStep(0)}),o.TgZ(20,"mat-expansion-panel-header")(21,"mat-panel-title"),o._uU(22," Bitacora "),o.qZA(),o.TgZ(23,"mat-panel-description"),o._uU(24," Datos de Bitacora "),o.qZA()(),o.TgZ(25,"div",14)(26,"div",15)(27,"div",16)(28,"h4"),o._uU(29,"Agregar Bitacora"),o.qZA()()(),o.TgZ(30,"div",17)(31,"div",18)(32,"mat-label",19),o._uU(33," Descripci\xf3n de averia "),o.TgZ(34,"span",20),o._uU(35,"*"),o.qZA()(),o._UZ(36,"input",21),o.qZA()(),o.TgZ(37,"div",17)(38,"div",18)(39,"mat-label",19),o._uU(40," Enlace/Anillo/Plano/Site "),o.TgZ(41,"span",20),o._uU(42,"*"),o.qZA()(),o._UZ(43,"input",22),o.qZA()(),o.TgZ(44,"div",23)(45,"div",18)(46,"mat-label",24),o._uU(47,"Fecha Inicial "),o.TgZ(48,"span",20),o._uU(49,"*"),o.qZA()(),o._UZ(50,"input",25),o.qZA()(),o.TgZ(51,"div",23)(52,"div",18)(53,"mat-label",26),o._uU(54,"Fecha Ejecuci\xf3n "),o.qZA(),o._UZ(55,"input",27),o.qZA()(),o.TgZ(56,"div",23)(57,"div",18)(58,"mat-label",28),o._uU(59,"Nro Incidencia "),o.qZA(),o._UZ(60,"input",29),o.qZA()(),o.TgZ(61,"div",23)(62,"div",18)(63,"mat-label",30),o._uU(64,"Nro Sot "),o.qZA(),o._UZ(65,"input",31),o.qZA()(),o.TgZ(66,"div",23)(67,"div",18)(68,"mat-label",32),o._uU(69,"Fecha SOT "),o.qZA(),o._UZ(70,"input",33),o.qZA()(),o.TgZ(71,"div",23)(72,"div",18)(73,"mat-label"),o._uU(74,"Tipo Averia "),o.TgZ(75,"span",20),o._uU(76,"*"),o.qZA()(),o.TgZ(77,"mat-select",34),o.YNc(78,ff,2,2,"mat-option",35),o.qZA()()(),o.TgZ(79,"div",23)(80,"div",18)(81,"mat-label",36),o._uU(82,"Latitud "),o.qZA(),o._UZ(83,"input",37),o.qZA()(),o.TgZ(84,"div",23)(85,"div",18)(86,"mat-label",38),o._uU(87,"Longitud "),o.qZA(),o._UZ(88,"input",39),o.qZA()(),o.TgZ(89,"div",23)(90,"div",18)(91,"mat-label",40),o._uU(92,"Distancia "),o.qZA(),o._UZ(93,"input",41),o.qZA()(),o.TgZ(94,"div",23)(95,"div",18)(96,"mat-label",42),o._uU(97,"Red1 "),o.TgZ(98,"span",20),o._uU(99,"*"),o.qZA()(),o.TgZ(100,"mat-select",43),o.YNc(101,lf,2,2,"mat-option",35),o.qZA()()(),o.TgZ(102,"div",23)(103,"div",18)(104,"mat-label"),o._uU(105,"Serv1 "),o.TgZ(106,"span",20),o._uU(107,"*"),o.qZA()(),o.TgZ(108,"mat-select",44),o.YNc(109,uf,2,2,"mat-option",35),o.qZA()()(),o.TgZ(110,"div",23)(111,"div",18)(112,"mat-label",45),o._uU(113,"Nro TAS"),o.qZA(),o._UZ(114,"input",46),o.qZA()(),o.TgZ(115,"div",23)(116,"div",18)(117,"mat-label",47),o._uU(118,"Nro CRQ"),o.qZA(),o._UZ(119,"input",48),o.qZA()(),o.TgZ(120,"div",23)(121,"div",49)(122,"mat-slide-toggle",50),o._uU(123,"Afectacion de Servicio "),o.qZA()()(),o.TgZ(124,"div",23)(125,"div",49)(126,"mat-slide-toggle",51),o._uU(127,"Afectacion de Masiva "),o.qZA()()()(),o.TgZ(128,"mat-action-row")(129,"button",52),o.NdJ("click",function(){return n.nextStep()}),o._uU(130," Siguiente "),o.qZA()()(),o.TgZ(131,"mat-expansion-panel",13),o.NdJ("opened",function(){return n.setStep(1)}),o.TgZ(132,"mat-expansion-panel-header")(133,"mat-panel-title"),o._uU(134," Sites "),o.qZA(),o.TgZ(135,"mat-panel-description"),o._uU(136," Seleccionar Site "),o.qZA()(),o.TgZ(137,"div",14)(138,"div",15)(139,"div",16)(140,"h4"),o._uU(141,"Datos Site"),o.qZA()()(),o.TgZ(142,"div",23)(143,"div",18)(144,"mat-label"),o._uU(145,"Buscar Site"),o.qZA(),o._UZ(146,"input",53),o.TgZ(147,"mat-autocomplete",54,55),o.YNc(149,hf,2,3,"mat-option",56),o.ALo(150,"async"),o.qZA()()(),o.TgZ(151,"div",23)(152,"div",18)(153,"mat-label"),o._uU(154,"C\xf3digo"),o.qZA(),o._UZ(155,"input",57),o.qZA()(),o.TgZ(156,"div",23)(157,"div",18)(158,"mat-label"),o._uU(159,"Zona"),o.qZA(),o._UZ(160,"input",57),o.qZA()(),o.TgZ(161,"div",23)(162,"div",18)(163,"mat-label",58),o._uU(164,"Cliente "),o.qZA(),o._UZ(165,"input",59),o.qZA()(),o.TgZ(166,"div",23)(167,"div",18)(168,"mat-label"),o._uU(169,"Region"),o.qZA(),o._UZ(170,"input",57),o.qZA()(),o.TgZ(171,"div",23)(172,"div",18)(173,"mat-label"),o._uU(174,"Departamento"),o.qZA(),o._UZ(175,"input",57),o.qZA()(),o.TgZ(176,"div",23)(177,"div",18)(178,"mat-label"),o._uU(179,"Provincia"),o.qZA(),o._UZ(180,"input",57),o.qZA()(),o.TgZ(181,"div",23)(182,"div",18)(183,"mat-label"),o._uU(184,"Distrito"),o.qZA(),o._UZ(185,"input",57),o.qZA()(),o.TgZ(186,"div",23)(187,"div",18)(188,"mat-label"),o._uU(189,"Latitud"),o.qZA(),o._UZ(190,"input",57),o.qZA()(),o.TgZ(191,"div",23)(192,"div",18)(193,"mat-label"),o._uU(194,"Longitud"),o.qZA(),o._UZ(195,"input",57),o.qZA()()(),o.TgZ(196,"mat-action-row")(197,"button",60),o.NdJ("click",function(){return n.prevStep()}),o._uU(198," Anterior "),o.qZA(),o.TgZ(199,"button",52),o.NdJ("click",function(){return n.nextStep()}),o._uU(200," Siguiente "),o.qZA()()(),o.TgZ(201,"mat-expansion-panel",13),o.NdJ("opened",function(){return n.setStep(2)}),o.TgZ(202,"mat-expansion-panel-header")(203,"mat-panel-title"),o._uU(204," Brigadas "),o.qZA(),o.TgZ(205,"mat-panel-description"),o._uU(206," Seleccionar Brigadas "),o.qZA()(),o.TgZ(207,"div",61)(208,"div",15)(209,"div",10)(210,"div",11)(211,"div",62)(212,"table",63)(213,"thead")(214,"tr")(215,"th"),o._uU(216,"Brigada"),o.qZA(),o.TgZ(217,"th"),o._uU(218,"T. Brigada"),o.qZA(),o.TgZ(219,"th"),o._uU(220,"Contrata"),o.qZA(),o.TgZ(221,"th"),o._uU(222,"Base"),o.qZA(),o.TgZ(223,"th"),o._uU(224,"Tecnicos"),o.qZA(),o.TgZ(225,"th"),o._uU(226," Acci\xf3n "),o.TgZ(227,"button",64),o.NdJ("click",function(){return n.onAddBrigada()}),o._UZ(228,"i",65),o.qZA()()()(),o.TgZ(229,"tbody"),o.YNc(230,xf,17,6,"ng-container",66),o.qZA()(),o.TgZ(231,"div",67)(232,"div",68)(233,"div",69),o._uU(234),o.qZA()(),o.TgZ(235,"div",70)(236,"div",71)(237,"ul",72)(238,"li",73)(239,"a",74),o.NdJ("click",function(){return n.getMoreData("previous")}),o._uU(240," Anterior "),o.qZA()(),o.YNc(241,_f,6,6,"ng-container",66),o.TgZ(242,"li",73)(243,"a",75),o.NdJ("click",function(){return n.getMoreData("next")}),o._uU(244,"Siguiente "),o.qZA()()()()()()()()()(),o.YNc(245,wf,13,1,"div",76),o.qZA(),o.TgZ(246,"div",61)(247,"div",15)(248,"div",77)(249,"div",78)(250,"h4",79),o._uU(251,"Brigada Seleccionada"),o.qZA(),o.TgZ(252,"div",62)(253,"table",63)(254,"thead")(255,"tr")(256,"th"),o._uU(257,"Base"),o.qZA(),o.TgZ(258,"th"),o._uU(259,"Brigada"),o.qZA(),o.TgZ(260,"th"),o._uU(261,"Acci\xf3n"),o.qZA()()(),o.TgZ(262,"tbody"),o.YNc(263,Tf,10,2,"ng-container",66),o.qZA()()()()()()(),o.TgZ(264,"mat-action-row")(265,"button",60),o.NdJ("click",function(){return n.prevStep()}),o._uU(266," Anterior "),o.qZA(),o.TgZ(267,"button",52),o.NdJ("click",function(){return n.nextStep()}),o._uU(268," Siguiente "),o.qZA()()(),o.TgZ(269,"mat-expansion-panel",13),o.NdJ("opened",function(){return n.setStep(3)}),o.TgZ(270,"mat-expansion-panel-header")(271,"mat-panel-title"),o._uU(272," Responsables "),o.qZA(),o.TgZ(273,"mat-panel-description"),o._uU(274," Seleccionar Responsables "),o.qZA()(),o.TgZ(275,"div",14)(276,"div",15)(277,"div",10)(278,"div",11)(279,"div",62)(280,"table",63)(281,"thead")(282,"tr")(283,"th"),o._uU(284,"Responsable Ciccsa"),o.qZA(),o.TgZ(285,"th"),o._uU(286,"Responsable Claro"),o.qZA()()(),o.TgZ(287,"tbody")(288,"tr")(289,"td",80)(290,"mat-radio-group",81),o.YNc(291,kf,2,3,"mat-radio-button",82),o.qZA()(),o.TgZ(292,"td",80)(293,"mat-radio-group",83),o.YNc(294,Ef,2,3,"mat-radio-button",82),o.qZA()()()()()()()()()(),o.TgZ(295,"mat-action-row")(296,"button",60),o.NdJ("click",function(){return n.prevStep()}),o._uU(297," Anterior "),o.qZA(),o.TgZ(298,"button",52),o.NdJ("click",function(){return n.saveBitacora()}),o._uU(299," Registrar "),o.qZA()()()()(),o.YNc(300,bf,3,0,"div",84),o.qZA()()()()()()),2&a){const i=o.MAs(148);o.xp6(19),o.Q6J("expanded",0===n.step),o.xp6(6),o.Q6J("formGroup",n.datosForm),o.xp6(53),o.Q6J("ngForOf",n.tipo_Averia),o.xp6(23),o.Q6J("ngForOf",n.red),o.xp6(8),o.Q6J("ngForOf",n.serv),o.xp6(20),o.Q6J("disabled",n.datosForm.invalid),o.xp6(2),o.Q6J("expanded",1===n.step),o.xp6(6),o.Q6J("formGroup",n.siteForm),o.xp6(9),o.Q6J("formControl",n.siteControl)("matAutocomplete",i),o.xp6(1),o.Q6J("displayWith",n.displayFn),o.xp6(2),o.Q6J("ngForOf",o.lcZ(150,46,n.filteredSites)),o.xp6(6),o.Q6J("value",null==n.site?null:n.site.codigo)("disabled",!0),o.xp6(5),o.Q6J("value",null==n.site||null==n.site.zona?null:n.site.zona.nombre)("disabled",!0),o.xp6(10),o.Q6J("value",null==n.site||null==n.site.region?null:n.site.region.nombre)("disabled",!0),o.xp6(5),o.Q6J("value",null==n.site||null==n.site.departamento?null:n.site.departamento.nombre)("disabled",!0),o.xp6(5),o.Q6J("value",null==n.site||null==n.site.provincia?null:n.site.provincia.nombre)("disabled",!0),o.xp6(5),o.Q6J("value",null==n.site||null==n.site.distrito?null:n.site.distrito.nombre)("disabled",!0),o.xp6(5),o.Q6J("value",null==n.site?null:n.site.latitud)("disabled",!0),o.xp6(5),o.Q6J("value",null==n.site?null:n.site.longitud)("disabled",!0),o.xp6(4),o.Q6J("disabled",n.siteForm.invalid),o.xp6(2),o.Q6J("expanded",2===n.step),o.xp6(29),o.Q6J("ngForOf",n.brigadas),o.xp6(4),o.lnq(" Mostrando ",n.serialNumberArray[0]," a ",n.serialNumberArray[n.serialNumberArray.length-1]," de ",n.totalData," cuadrillas "),o.xp6(4),o.Q6J("ngClass",o.VKq(48,As,1===n.currentPage)),o.xp6(3),o.Q6J("ngForOf",n.pageNumberArray),o.xp6(1),o.Q6J("ngClass",o.VKq(50,As,n.currentPage===n.pageNumberArray[n.pageNumberArray.length-1]||0===n.brigadas.length)),o.xp6(3),o.Q6J("ngIf",n.brigadaSelected),o.xp6(18),o.Q6J("ngForOf",n.brigadasForm.value.brigadas),o.xp6(4),o.Q6J("disabled",n.brigadasForm.invalid),o.xp6(2),o.Q6J("expanded",3===n.step),o.xp6(6),o.Q6J("formGroup",n.responsablesForm),o.xp6(16),o.Q6J("ngForOf",n.responsables_cicsa),o.xp6(3),o.Q6J("ngForOf",n.responsables_claro),o.xp6(4),o.Q6J("disabled",n.datosForm.invalid||n.siteForm.invalid||n.brigadasForm.invalid||n.responsablesForm.invalid),o.xp6(2),o.Q6J("ngIf",n.bitacora.id)}},dependencies:[Je.mk,Je.sg,Je.O5,ws.hX,Ts.gD,ks.ey,ca.pp,ca.ib,ca.VG,ca.yz,ca.yK,ca.u4,dt.lW,ue._Y,ue.Fj,ue.wV,ue.JJ,ue.JL,ue.F,Es.XC,Es.ZL,bs.VQ,bs.U0,cf.Rr,ue.oH,ue.sg,ue.u,Je.Ov],styles:['@charset "UTF-8";.mat-mdc-form-field[_ngcontent-%COMP%] + .mat-mdc-form-field[_ngcontent-%COMP%]{margin-left:8px}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0;align-items:flex-start}.example-radio-button[_ngcontent-%COMP%]{margin:5px}mat-slide-toggle[_ngcontent-%COMP%]{display:inline-flex;align-items:center}']})}return e})();var Af=xe(3583),Sf=xe(9909),Ff=xe(342);const yf=["invoiceTotalInner"];function Cf(e,t){if(1&e&&(o.TgZ(0,"pre"),o._uU(1),o.qZA()),2&e){const r=o.oxw();o.xp6(1),o.hij("",r.bitacoraPrint,"\n                ")}}let ei=(()=>{class e{constructor(r,a,n,i,s,c,f){this.dialogRef=r,this.data=a,this.clipboard=n,this._snackBar=i,this.bitacoraService=s,this.datePipe=c,this.utilities=f,this.brigadas="",this.atenciones="",this.causas="",this.count=1,this.bitacoraPrint="",this.sessionId="",this.bitacoraService.read(a.id).subscribe(l=>{this.bitacora=l,this.bitacoraPrint=this.utilities.armaBitacora(l)})}copiarTexto(){this.clipboard.copy(this.invoiceTotalInner.nativeElement.innerText),this.utilities.snackBar("Bicatora copiada")}enviaWhatsAap(){const r=localStorage.getItem("user"),a=r?JSON.parse(r):null;if(a&&a.name&&(this.sessionId=a.whatsapp),this.bitacora&&this.bitacora.id){const n=this.bitacora.id;this.bitacoraService.groupWhastApp(this.bitacora.tipo_averia.id).subscribe(i=>{const c=i.data.map(f=>f.nombre);console.log(c),this.utilities.enviarMensajeAGrupos(this.sessionId,c,n)})}else this.utilities.snackBar("no se registro Grupos de Whasap")}static#e=this.\u0275fac=function(a){return new(a||e)(o.Y36(Oe.so),o.Y36(Oe.WI),o.Y36(Ff.TU),o.Y36(At.ux),o.Y36(Ce.k),o.Y36(Je.uU),o.Y36(ba.e))};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-view-bitacoras"]],viewQuery:function(a,n){if(1&a&&o.Gf(yf,7),2&a){let i;o.iGM(i=o.CRH())&&(n.invoiceTotalInner=i.first)}},features:[o._Bn([Je.uU])],decls:19,vars:1,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"invoice-total-card"],[1,"invoice-total-title"],["href","javascript:void(0);",1,"me-2",3,"click"],[1,"fas","fa-clone"],[1,"invoice-total-box"],[1,"invoice-total-inner"],["invoiceTotalInner",""],[4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"click"],[1,"fab","fa-whatsapp"]],template:function(a,n){1&a&&(o.TgZ(0,"h2",0),o._uU(1,"Detalle Bitacora"),o.qZA(),o.TgZ(2,"mat-dialog-content",1)(3,"div",2)(4,"h4",3),o._uU(5,"Copiar el texto al chat WhatsApp"),o.qZA(),o.TgZ(6,"a",4),o.NdJ("click",function(){return n.copiarTexto()}),o._UZ(7,"i",5),o.qZA(),o.TgZ(8,"div",6)(9,"div",7,8),o.YNc(11,Cf,2,1,"pre",9),o.qZA()()()(),o.TgZ(12,"mat-dialog-actions",10)(13,"button",11),o._uU(14,"Cerrar"),o.qZA(),o.TgZ(15,"button",12),o.NdJ("click",function(){return n.copiarTexto()}),o._UZ(16,"i",5),o.qZA(),o.TgZ(17,"button",12),o.NdJ("click",function(){return n.enviaWhatsAap()}),o._UZ(18,"i",13),o.qZA()()),2&a&&(o.xp6(11),o.Q6J("ngIf",n.bitacoraPrint))},dependencies:[Je.O5,dt.lW,Oe.ZT,Oe.uh,Oe.xY,Oe.H8],styles:["img[_ngcontent-%COMP%]{border:4px solid #0d6efd;border-radius:8px}"]})}return e})();function Rf(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"i",14),o.NdJ("click",function(){o.CHM(r);const n=o.oxw();return o.KtG(n.newDemora())}),o.qZA()}}function Df(e,t){if(1&e&&(o.TgZ(0,"mat-option",32),o._uU(1),o.qZA()),2&e){const r=t.$implicit;o.Q6J("value",r.id),o.xp6(1),o.hij(" ",r.nombre," ")}}function If(e,t){if(1&e){const r=o.EpF();o.ynx(0,15)(1,16),o.TgZ(2,"div",17)(3,"div",18)(4,"mat-label",19),o._uU(5,"Tipo Demora "),o.TgZ(6,"span",20),o._uU(7,"*"),o.qZA()(),o.TgZ(8,"mat-select",21),o.YNc(9,Df,2,2,"mat-option",22),o.qZA()()(),o.TgZ(10,"div",23)(11,"div",18)(12,"mat-label",24),o._uU(13," Hora de inicio "),o.TgZ(14,"span",20),o._uU(15,"*"),o.qZA()(),o.TgZ(16,"input",25),o.NdJ("change",function(n){const s=o.CHM(r).$implicit,c=o.oxw();return o.KtG(c.updateTiempoDemoras(n.target,"inicio",s.value))}),o.qZA()()(),o.TgZ(17,"div",23)(18,"div",18)(19,"mat-label",26),o._uU(20," Hora fin "),o.TgZ(21,"span",20),o._uU(22,"*"),o.qZA()(),o.TgZ(23,"input",27),o.NdJ("change",function(n){const s=o.CHM(r).$implicit,c=o.oxw();return o.KtG(c.updateTiempoDemoras(n.target,"fin",s.value))}),o.qZA()()(),o.TgZ(24,"div",28)(25,"div",18)(26,"mat-label",26),o._uU(27," SLA "),o.qZA(),o._uU(28),o.qZA()(),o.TgZ(29,"div",29)(30,"button",30),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.removeDemora(i.value.id))}),o._UZ(31,"i",31),o.qZA()(),o.BQk()()}if(2&e){const r=t.index,a=o.oxw();o.xp6(1),o.Q6J("formGroupName",r),o.xp6(8),o.Q6J("ngForOf",a.tipoDemora),o.xp6(19),o.hij(" ",a.demorasBitacora[r].tiempoDemora," ")}}let Nf=(()=>{class e{get demorasArray(){return this.demorasForm.controls.demo}constructor(r,a,n,i,s,c,f,l){this.dialogRef=r,this.data=a,this._snackBar=n,this.bitacoraService=i,this.configService=s,this.fb=c,this.router=f,this.time_utils=l,this.tipoDemora=[],this.demorasBitacora=[],this.totalDemoras="",this.bitacora=a.bitacora,this.demorasForm=this.fb.group({demo:this.fb.array([],ue.kI.required)})}ngOnInit(){this.configService.bitacorasDemoras().subscribe(r=>{this.tipoDemora=r.demoras}),this.bitacoraService.listDemoras(this.bitacora.id).subscribe(r=>{this.demorasBitacora=r.data.map(a=>({...a,tiempoDemora:""})),this.updateTiempoDemoras(null),this.updateTotalDemoras(this.demorasBitacora),this.demorasForm.reset(),this.demorasBitacora.forEach(a=>{this.addDemora(a,!1)})})}newDemora(){const r=this.time_utils.getLocalDateTime(),n={id:this.demorasBitacora.reduce((i,s)=>Math.max(i,s.id??0),0)+1,bitacora_id:this.bitacora.id,tipo_demora_id:0,fecha_inicio:r,fecha_fin:r,orden:this.demorasBitacora.length+1};this.addDemora(n,!0)}removeDemora(r){this.addDemora({id:r},!0)}addDemora(r,a){const n=this.demorasForm.get("demo"),s=n.value.findIndex(c=>c.id==r.id);-1!=s?n.removeAt(s):n.push(this.fb.group({id:[r.id,ue.kI.required],bitacora_id:[r.bitacora_id,ue.kI.required],tipo_demora_id:[r.tipo_demora_id,[ue.kI.required,ue.kI.min(1)]],fecha_inicio:[r.fecha_inicio,ue.kI.required],fecha_fin:[r.fecha_fin,ue.kI.required],orden:[r.orden,ue.kI.required]},{validators:this.time_utils.fechaEjecucionMayorValidator("fecha_inicio","fecha_fin")})),this.demorasForm.setControl("demo",n),a&&(this.demorasBitacora=n.value,this.updateTiempoDemoras(null))}save(){console.log(this.bitacora),console.log(this.demorasForm.value);const r={...this.bitacora,...this.demorasForm.value};console.log(r),this.bitacoraService.demoras(r).subscribe(a=>{console.log(a),403==a.message?this.snackBar("Falta ingresar datos"):(this.snackBar("Registro Exitoso"),this.router.navigate(["/bitacoras/list-bitacora"]))})}snackBar(r){this._snackBar.open(r,"Cerrar",{horizontalPosition:"right",verticalPosition:"top",duration:3e3})}calcularTiempoDemora(r){const i=new Date(r.fecha_fin).valueOf()-new Date(r.fecha_inicio).valueOf(),s=Math.floor(i/1e3/60/60),c=i/1e3/60-60*s;return s.toString().padStart(2,"0")+":"+c.toString().padStart(2,"0")}updateTotalDemoras(r){let a=0;for(let s=0;s<r.length;s++){const c=r[s];a+=new Date(c.fecha_fin).valueOf()-new Date(c.fecha_inicio).valueOf()}const n=Math.floor(a/1e3/60/60),i=a/1e3/60-60*n;this.totalDemoras=n.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")}updateTiempoDemoras(r,a,n){this.demorasBitacora=this.demorasBitacora.map(i=>(i.id===n?.id&&("inicio"===a?i.fecha_inicio=r.value:"fin"===a&&(i.fecha_fin=r.value)),{...i,tiempoDemora:this.calcularTiempoDemora(i)})),this.updateTotalDemoras(this.demorasBitacora)}fechaValidator(r){const a=r.get("fecha_inicio")?.value,n=r.get("fecha_fin")?.value;return a&&n&&new Date(a)>new Date(n)?{fechasInvalidas:!0}:null}static#e=this.\u0275fac=function(a){return new(a||e)(o.Y36(Oe.so),o.Y36(Oe.WI),o.Y36(At.ux),o.Y36(Ce.k),o.Y36(Lr.E),o.Y36(ue.qu),o.Y36(Ir.F0),o.Y36(un))};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-add-demoras"]],decls:22,vars:6,consts:[["mat-dialog-title",""],["class","fas fa-plus-circle","aria-hidden","true",3,"click",4,"ngIf"],[1,"mat-typography"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-body"],[3,"formGroup"],[1,"row","align-items-center"],["formArrayName","demo",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close","disabled","click"],["aria-hidden","true",1,"fas","fa-plus-circle",3,"click"],["formArrayName","demo"],[3,"formGroupName"],[1,"col-12","col-md-4","col-xl-4"],[1,"form-group","local-forms"],["for","tipo_demora_id"],[1,"login-danger"],["formControlName","tipo_demora_id","placeholder","Selec. Tip. Demora",1,"form-control","select"],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-md-3","col-xl-3"],["for","fecha_inicio"],["type","datetime-local","formControlName","fecha_inicio","name","fecha_inicio",1,"form-control",3,"change"],["for","fecha_fin"],["type","datetime-local","formControlName","fecha_fin","name","fecha_fin",1,"form-control",3,"change"],[1,"col-12","col-md-3","col-xl-1"],[1,"col-12","col-md-2","col-xl-1","space-x-4","flex",2,"height","50px"],["aria-hidden","true",1,"btn","btn-primary","ms-1",3,"click"],[1,"fas","fa-trash-alt"],[3,"value"]],template:function(a,n){1&a&&(o.TgZ(0,"h2",0),o._uU(1,"Agregar Demoras "),o.TgZ(2,"a"),o.YNc(3,Rf,1,0,"i",1),o.qZA()(),o.TgZ(4,"mat-dialog-content",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"form",7)(10,"div",8),o.YNc(11,If,32,3,"ng-container",9),o.qZA(),o.TgZ(12,"div",10)(13,"div"),o._uU(14,"Total SLA: "),o.qZA(),o.TgZ(15,"div"),o._uU(16),o.qZA()()()()()()()(),o.TgZ(17,"mat-dialog-actions",11)(18,"button",12),o._uU(19,"Cerrar"),o.qZA(),o.TgZ(20,"button",13),o.NdJ("click",function(){return n.save()}),o._uU(21,"Guardar"),o.qZA()()),2&a&&(o.xp6(3),o.Q6J("ngIf",n.demorasArray.length<3),o.xp6(6),o.Q6J("formGroup",n.demorasForm),o.xp6(2),o.Q6J("ngForOf",n.demorasArray.controls),o.xp6(5),o.hij("",n.totalDemoras," hrs."),o.xp6(4),o.Q6J("mat-dialog-close",!0)("disabled",n.demorasForm.invalid))},dependencies:[Je.sg,Je.O5,ws.hX,Ts.gD,ks.ey,dt.lW,Oe.ZT,Oe.uh,Oe.xY,Oe.H8,ue._Y,ue.Fj,ue.JJ,ue.JL,ue.sg,ue.u,ue.x0,ue.CE]})}return e})();var cr=null;function ua(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function et(e,t){var r=""+e;return r.length>=t?r:je("0",t-r.length)+r}function ai(e,t){var r=""+e;return r.length>=t?r:je(" ",t-r.length)+r}function mn(e,t){var r=""+e;return r.length>=t?r:r+je(" ",t-r.length)}var ys=Math.pow(2,32);function ha(e,t){return e>ys||e<-ys?function Zf(e,t){var r=""+Math.round(e);return r.length>=t?r:je("0",t-r.length)+r}(e,t):function Hf(e,t){var r=""+e;return r.length>=t?r:je("0",t-r.length)+r}(Math.round(e),t)}function _n(e,t){return e.length>=7+(t=t||0)&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var Cs=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ni=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],de={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Rs={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vf={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gn(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,s=1,c=0,f=1,l=0,u=0,h=Math.floor(n);l<t&&(c=(h=Math.floor(n))*s+i,u=h*l+f,!(n-h<5e-8));)n=1/(n-h),i=s,s=c,f=l,l=u;if(u>t&&(l>t?(u=f,c=i):(u=l,c=s)),!r)return[0,a*c,u];var p=Math.floor(a*c/u);return[p,a*c-p*u,u]}function yt(e,t,r){if(e>2958465||e<0)return null;var a=0|e,n=Math.floor(86400*(e-a)),i=0,s=[],c={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,86400==++n&&(c.T=n=0,++a,++c.D)),60===a)s=r?[1317,10,29]:[1900,2,29],i=3;else if(0===a)s=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),s=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),a<60&&(i=(i+6)%7),r&&(i=function zf(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}(f,s))}return c.y=s[0],c.m=s[1],c.d=s[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=i,c}var Ds=new Date(1899,11,31,0,0,0),Gf=Ds.getTime(),jf=new Date(1900,2,1,0,0,0);function Is(e,t){var r=e.getTime();return t?r-=1262304e5:e>=jf&&(r+=864e5),(r-(Gf+6e4*(e.getTimezoneOffset()-Ds.getTimezoneOffset())))/864e5}function ii(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Gt(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):function Ra(e){var r,t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return r=t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?function Xf(e){var t=e<0?12:11,r=ii(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===t?e.toFixed(10).substr(0,12):function qf(e){var t=ii(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),ii(function $f(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(r.toUpperCase()))}(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return it(14,Is(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Yf(e,t,r,a){var f,n="",i=0,s=0,c=r.y,l=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,l=2;break;default:f=c%1e4,l=4}break;case 109:switch(t.length){case 1:case 2:f=r.m,l=t.length;break;case 3:return ni[r.m-1][1];case 5:return ni[r.m-1][0];default:return ni[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,l=t.length;break;case 3:return Cs[r.q][0];default:return Cs[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(s=a>=2?3===a?1e3:100:1===a?10:1,(i=Math.round(s*(r.S+r.u)))>=60*s&&(i=0),"s"===t?0===i?"0":""+i/s:(n=et(i,2+a),"ss"===t?n.substr(0,2):"."+n.substr(2,t.length-1))):et(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":f=24*r.D+r.H;break;case"[m]":case"[mm]":f=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":f=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:f=c,l=1}return l>0?et(f,l):""}function Ct(e){if(e.length<=3)return e;for(var r=e.length%3,a=e.substr(0,r);r!=e.length;r+=3)a+=(a.length>0?",":"")+e.substr(r,3);return a}var Ns=/%/g;function Os(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Os(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),-1===(r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,l,u){return f+l+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Bs=/# (\?+)( ?)\/( ?)(\d+)/,Ps=/^#*0*\.([0#]+)/,Ls=/\).*[0#]/,Ms=/\(###\) ###\\?-####/;function Cr(e){for(var r,t="",a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Us(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Zs(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function jr(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ls)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?jr("n",a,r):"("+jr("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function Kf(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return mt(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function Jf(e,t,r){var a=t.replace(Ns,""),n=t.length-a.length;return mt(e,a,r*Math.pow(10,2*n))+je("%",n)}(e,t,r);if(-1!==t.indexOf("E"))return Os(t,r);if(36===t.charCodeAt(0))return"$"+jr(e,t.substr(" "==t.charAt(1)?2:1),r);var n,i,s,c,f=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+ha(f,t.length);if(t.match(/^[#?]+$/))return"0"===(n=ha(r,0))&&(n=""),n.length>t.length?n:Cr(t.substr(0,t.length-n.length))+n;if(i=t.match(Bs))return function Qf(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),s=n-i*a,c=a;return r+(0===i?"":""+i)+" "+(0===s?je(" ",e[1].length+1+e[4].length):ai(s,e[1].length)+e[2]+"/"+e[3]+et(c,e[4].length))}(i,f,l);if(t.match(/^#+0+$/))return l+ha(f,t.length-t.indexOf("0"));if(i=t.match(Ps))return n=Us(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Cr(i[1])).replace(/\.$/,"."+Cr(i[1])).replace(/\.(\d*)$/,function(_,x){return"."+x+je("0",Cr(i[1]).length-x.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+Us(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Ct(ha(f,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+jr(e,t,-r):Ct(""+(Math.floor(r)+function rl(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,i[1].length)))+"."+et(Zs(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return jr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ua(jr(e,t.replace(/[\\-]/g,""),r)),s=0,ua(ua(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return s<n.length?n.charAt(s++):"0"===_?"0":""}));if(t.match(Ms))return"("+(n=jr(e,"##########",r)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=gn(f,Math.pow(10,s)-1,!1),n=""+l," "==(u=mt("n",i[1],c[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],(u=mn(c[2],s)).length<i[4].length&&(u=Cr(i[4].substr(i[4].length-u.length))+u),n+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l+((c=gn(f,Math.pow(10,s)-1,!0))[0]||(c[1]?"":"0"))+" "+(c[1]?ai(c[1],s)+i[2]+"/"+i[3]+mn(c[2],s):je(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=ha(r,0),t.length<=n.length?n:Cr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var h=t.indexOf(".")-s,p=t.length-n.length-h;return Cr(t.substr(0,h)+n+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Zs(r,i[1].length),r<0?"-"+jr(e,t,-r):Ct(function tl(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?et(0,3-_.length):"")+_})+"."+et(s,i[1].length);switch(t){case"###,##0.00":return jr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ct(ha(f,0));return"0"!==m?l+m:"";case"###,###.00":return jr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return jr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Hs(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Hs(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),!(r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,l,u){return f+l+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function nt(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ls)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nt("n",a,r):"("+nt("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function al(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return mt(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function nl(e,t,r){var a=t.replace(Ns,""),n=t.length-a.length;return mt(e,a,r*Math.pow(10,2*n))+je("%",n)}(e,t,r);if(-1!==t.indexOf("E"))return Hs(t,r);if(36===t.charCodeAt(0))return"$"+nt(e,t.substr(" "==t.charAt(1)?2:1),r);var n,i,s,c,f=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+et(f,t.length);if(t.match(/^[#?]+$/))return n=""+r,0===r&&(n=""),n.length>t.length?n:Cr(t.substr(0,t.length-n.length))+n;if(i=t.match(Bs))return function el(e,t,r){return r+(0===t?"":""+t)+je(" ",e[1].length+2+e[4].length)}(i,f,l);if(t.match(/^#+0+$/))return l+et(f,t.length-t.indexOf("0"));if(i=t.match(Ps))return n=(n=(""+r).replace(/^([^\.]+)$/,"$1."+Cr(i[1])).replace(/\.$/,"."+Cr(i[1]))).replace(/\.(\d*)$/,function(_,x){return"."+x+je("0",Cr(i[1]).length-x.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Ct(""+f);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nt(e,t,-r):Ct(""+r)+"."+je("0",i[1].length);if(i=t.match(/^#,#*,#0/))return nt(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ua(nt(e,t.replace(/[\\-]/g,""),r)),s=0,ua(ua(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return s<n.length?n.charAt(s++):"0"===_?"0":""}));if(t.match(Ms))return"("+(n=nt(e,"##########",r)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=gn(f,Math.pow(10,s)-1,!1),n=""+l," "==(u=mt("n",i[1],c[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],(u=mn(c[2],s)).length<i[4].length&&(u=Cr(i[4].substr(i[4].length-u.length))+u),n+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l+((c=gn(f,Math.pow(10,s)-1,!0))[0]||(c[1]?"":"0"))+" "+(c[1]?ai(c[1],s)+i[2]+"/"+i[3]+mn(c[2],s):je(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return t.length<=(n=""+r).length?n:Cr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var h=t.indexOf(".")-s,p=t.length-n.length-h;return Cr(t.substr(0,h)+n+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+nt(e,t,-r):Ct(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?et(0,3-_.length):"")+_})+"."+et(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Ct(""+f);return"0"!==m?l+m:"";default:if(t.match(/\.[0#?]*$/))return nt(e,t.slice(0,t.lastIndexOf(".")),r)+Cr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function mt(e,t,r){return(0|r)===r?nt(e,t,r):jr(e,t,r)}var Ws=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Da(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":_n(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase()||"AM/PM"===e.substr(t,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(Ws))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(" "==e.charAt(t)||"*"==e.charAt(t))&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Vs=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gs(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function it(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:de)[e])&&(a=r.table&&r.table[Rs[e]]||de[Rs[e]]),null==a&&(a=Vf[e]||"General")}if(_n(a,0))return Gt(t,r);t instanceof Date&&(t=Is(t,r.date1904));var n=function ol(e,t){var r=function il(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var i=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,i];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var s=r[0].match(Vs),c=r[1].match(Vs);return Gs(t,s)?[a,r[0]]:Gs(t,c)?[a,r[1]]:[a,r[null!=s&&null!=c?2:1]]}return[a,i]}(a,t);if(_n(n[1]))return Gt(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function sl(e,t,r,a){for(var l,u,h,n=[],i="",s=0,c="",f="t",p="H";s<e.length;)switch(c=e.charAt(s)){case"G":if(!_n(e,s))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";34!==(h=e.charCodeAt(++s))&&s<e.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++s;break;case"\\":var m=e.charAt(++s);n[n.length]={t:"("===m||")"===m?m:"t",v:m},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:t},++s;break;case"B":case"b":if("1"===e.charAt(s+1)||"2"===e.charAt(s+1)){if(null==l&&null==(l=yt(t,r,"2"===e.charAt(s+1))))return"";n[n.length]={t:"X",v:e.substr(s,2)},f=c,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||null==l&&null==(l=yt(t,r)))return"";for(i=c;++s<e.length&&e.charAt(s).toLowerCase()===c;)i+=c;"m"===c&&"h"===f.toLowerCase()&&(c="M"),"h"===c&&(c=p),n[n.length]={t:c,v:i},f=c;break;case"A":case"a":case"\u4e0a":var x={t:c,v:c};if(null==l&&(l=yt(t,r)),"A/P"===e.substr(s,3).toUpperCase()?(null!=l&&(x.v=l.H>=12?"P":"A"),x.t="T",p="h",s+=3):"AM/PM"===e.substr(s,5).toUpperCase()?(null!=l&&(x.v=l.H>=12?"PM":"AM"),x.t="T",s+=5,p="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(s,5).toUpperCase()?(null!=l&&(x.v=l.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),x.t="T",s+=5,p="h"):(x.t="t",++s),null==l&&"T"===x.t)return"";n[n.length]=x,f=c;break;case"[":for(i=c;"]"!==e.charAt(s++)&&s<e.length;)i+=e.charAt(s);if("]"!==i.slice(-1))throw'unterminated "[" block: |'+i+"|";if(i.match(Ws)){if(null==l&&null==(l=yt(t,r)))return"";n[n.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Da(e)||(n[n.length]={t:"t",v:i}));break;case".":if(null!=l){for(i=c;++s<e.length&&"0"===(c=e.charAt(s));)i+=c;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++s<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(s))>-1;)i+=c;n[n.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++s)===c;)i+=c;n[n.length]={t:c,v:i},f=c;break;case"*":++s,(" "==e.charAt(s)||"*"==e.charAt(s))&&++s;break;case"(":case")":n[n.length]={t:1===a?"t":c,v:c},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:c,v:c},++s;break;case"$":n[n.length]={t:"t",v:"$"},++s;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"t",v:c},++s}var F,T=0,S=0;for(s=n.length-1,f="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=p,f="h",T<1&&(T=1);break;case"s":(F=n[s].v.match(/\.0+$/))&&(S=Math.max(S,F[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=n[s].t;break;case"m":"s"===f&&(n[s].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&n[s].v.match(/[Hh]/)&&(T=1),T<2&&n[s].v.match(/[Mm]/)&&(T=2),T<3&&n[s].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M)}var O,b="";for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=Yf(n[s].t.charCodeAt(0),n[s].v,l,S),n[s].t="t";break;case"n":case"?":for(O=s+1;null!=n[O]&&("?"===(c=n[O].t)||"D"===c||(" "===c||"t"===c)&&null!=n[O+1]&&("?"===n[O+1].t||"t"===n[O+1].t&&"/"===n[O+1].v)||"("===n[s].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===n[O].v||" "===n[O].v&&null!=n[O+1]&&"?"==n[O+1].t));)n[s].v+=n[O].v,n[O]={v:"",t:";"},++O;b+=n[s].v,s=O-1;break;case"G":n[s].t="t",n[s].v=Gt(t,r)}var M,y,U="";if(b.length>0){40==b.charCodeAt(0)?(M=t<0&&45===b.charCodeAt(0)?-t:t,y=mt("n",b,M)):(y=mt("n",b,M=t<0&&a>1?-t:t),M<0&&n[0]&&"t"==n[0].t&&(y=y.substr(1),n[0].v="-"+n[0].v)),O=y.length-1;var H=n.length;for(s=0;s<n.length;++s)if(null!=n[s]&&"t"!=n[s].t&&n[s].v.indexOf(".")>-1){H=s;break}var N=n.length;if(H===n.length&&-1===y.indexOf("E")){for(s=n.length-1;s>=0;--s)null==n[s]||-1==="n?".indexOf(n[s].t)||(O>=n[s].v.length-1?n[s].v=y.substr(1+(O-=n[s].v.length),n[s].v.length):O<0?n[s].v="":(n[s].v=y.substr(0,O+1),O=-1),n[s].t="t",N=s);O>=0&&N<n.length&&(n[N].v=y.substr(0,O+1)+n[N].v)}else if(H!==n.length&&-1===y.indexOf("E")){for(O=y.indexOf(".")-1,s=H;s>=0;--s)if(null!=n[s]&&-1!=="n?".indexOf(n[s].t)){for(u=n[s].v.indexOf(".")>-1&&s===H?n[s].v.indexOf(".")-1:n[s].v.length-1,U=n[s].v.substr(u+1);u>=0;--u)O>=0&&("0"===n[s].v.charAt(u)||"#"===n[s].v.charAt(u))&&(U=y.charAt(O--)+U);n[s].v=U,n[s].t="t",N=s}for(O>=0&&N<n.length&&(n[N].v=y.substr(0,O+1)+n[N].v),O=y.indexOf(".")+1,s=H;s<n.length;++s)if(null!=n[s]&&(-1!=="n?(".indexOf(n[s].t)||s===H)){for(u=n[s].v.indexOf(".")>-1&&s===H?n[s].v.indexOf(".")+1:0,U=n[s].v.substr(0,u);u<n[s].v.length;++u)O<y.length&&(U+=y.charAt(O++));n[s].v=U,n[s].t="t",N=s}}}for(s=0;s<n.length;++s)null!=n[s]&&"n?".indexOf(n[s].t)>-1&&(n[s].v=mt(n[s].t,n[s].v,M=a>1&&t<0&&s>0&&"-"===n[s-1].v?-t:t),n[s].t="t");var V="";for(s=0;s!==n.length;++s)null!=n[s]&&(V+=n[s].v);return V}(n[1],t,r,n[0])}function Ke(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function si(e){for(var t=[],r=Ke(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}var wn=new Date(1899,11,30,0,0,0);function Nr(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(wn.getTime()+6e4*(e.getTimezoneOffset()-wn.getTimezoneOffset())))/864e5}var qs=new Date("2017-02-19T19:06:09.000Z"),zs=isNaN(qs.getFullYear())?new Date("2/19/17"):qs,gl=2017==zs.getFullYear();function Or(e,t){var r=new Date(e);if(gl)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==zs.getFullYear()&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function je(e,t){for(var r="";r.length<t;)r+=e;return r}function Tn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(a))&&(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),isNaN(t=Number(a)))?t:t/r}var vl=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ys(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==vl.indexOf(s))return r}else if(s.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&101!=a?t:e.match(/[^-0-9:,\/\\]/)?r:t}var li=si({"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"}),ui=/[&<>'"]/g,n0=/[\u0000-\u001f]/g;function s0(e){return(e+"").replace(ui,function(r){return li[r]}).replace(/\n/g,"<br/>").replace(n0,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var l0=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),h0=/(^\s|\s$|\n)/;function X(e,t,r){return"<"+e+(null!=r?function d0(e){return Ke(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}(r):"")+(null!=t?(t.match(h0)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ur(e){return""+(e+1)}function qe(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function rt(e){var t=e.indexOf(":");return-1==t?{s:tr(e),e:tr(e)}:{s:tr(e.slice(0,t)),e:tr(e.slice(t+1))}}function Ae(e,t){return typeof t>"u"||"number"==typeof t?Ae(e.s,e.e):("string"!=typeof e&&(e=be(e)),"string"!=typeof t&&(t=be(t)),e==t?e:e+":"+t)}function Pe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||10!=n)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function ma(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?vt[e.v]||e.v:function D0(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=it(e.z,r?Nr(t):t)}catch{}try{return e.w=it((e.XF||{}).numFmtId||(r?14:0),r?Nr(t):t)}catch{return""+t}}(e,null==t?e.v:t))}function N0(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense;null!=cr&&null==n&&(n=cr);var i=e||(n?[]:{}),s=0,c=0;if(i&&null!=a.origin){if("number"==typeof a.origin)s=a.origin;else{var f="string"==typeof a.origin?tr(a.origin):a.origin;s=f.r,c=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Pe(i["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),-1==s&&(l.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var m={v:t[h][p]},_=s+h,x=c+p;if(l.s.r>_&&(l.s.r=_),l.s.c>x&&(l.s.c=x),l.e.r<_&&(l.e.r=_),l.e.c<x&&(l.e.c=x),!t[h][p]||"object"!=typeof t[h][p]||Array.isArray(t[h][p])||t[h][p]instanceof Date)if(Array.isArray(m.v)&&(m.f=t[h][p][1],m.v=m.v[0]),null===m.v)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else{if(!a.sheetStubs)continue;m.t="z"}else"number"==typeof m.v?m.t="n":"boolean"==typeof m.v?m.t="b":m.v instanceof Date?(m.z=a.dateNF||de[14],a.cellDates?(m.t="d",m.w=it(m.z,Nr(m.v))):(m.t="n",m.v=Nr(m.v),m.w=it(m.z,m.v))):m.t="s";else m=t[h][p];if(n)i[_]||(i[_]=[]),i[_][x]&&i[_][x].z&&(m.z=i[_][x].z),i[_][x]=m;else{var T=be({c:x,r:_});i[T]&&i[T].z&&(m.z=i[T].z),i[T]=m}}}return l.s.c<1e7&&(i["!ref"]=Ae(l)),i}var vt={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ug="][*?/\\".split("");function Tc(e,t,r,a){for(var n=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var c=0,f=0,l=0;l<n.length;++l)if(!(n[l].s.r>r||n[l].s.c>s||n[l].e.r<r||n[l].e.c<s)){if(n[l].s.r<r||n[l].s.c<s){c=-1;break}c=n[l].e.r-n[l].s.r+1,f=n[l].e.c-n[l].s.c+1;break}if(!(c<0)){var u=be({r,c:s}),h=a.dense?(e[r]||[])[s]:e[u],p=h&&null!=h.v&&(h.h||s0(h.w||(ma(h),h.w)||""))||"",m={};c>1&&(m.rowspan=c),f>1&&(m.colspan=f),a.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",null!=h.v&&(m["data-v"]=h.v),null!=h.z&&(m["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(a.id||"sjs")+"-"+u,i.push(X("td",p,m))}}return"<tr>"+i.join("")+"</tr>"}function Sc(e,t,r){var a=r||{};null!=cr&&(a.dense=cr);var n=0,i=0;if(null!=a.origin)if("number"==typeof a.origin)n=a.origin;else{var s="string"==typeof a.origin?tr(a.origin):a.origin;n=s.r,i=s.c}var c=t.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,c.length),l={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var u=rt(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),-1==n&&(l.e.r=n=u.e.r+1)}var h=[],p=0,m=e["!rows"]||(e["!rows"]=[]),_=0,x=0,T=0,S=0,F=0,b=0;for(e["!cols"]||(e["!cols"]=[]);_<c.length&&x<f;++_){var O=c[_];if(yc(O)){if(a.display)continue;m[x]={hidden:!0}}var U=O.children;for(T=S=0;T<U.length;++T){var M=U[T];if(!a.display||!yc(M)){var y=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):l0(M.innerHTML),H=M.getAttribute("data-z")||M.getAttribute("z");for(p=0;p<h.length;++p){var N=h[p];N.s.c==S+i&&N.s.r<x+n&&x+n<=N.e.r&&(S=N.e.c+1-i,p=-1)}b=+M.getAttribute("colspan")||1,((F=+M.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:x+n,c:S+i},e:{r:x+n+(F||1)-1,c:S+i+(b||1)-1}});var V={t:"s",v:y},Y=M.getAttribute("data-t")||M.getAttribute("t")||"";null!=y&&(0==y.length?V.t=Y||"z":a.raw||0==y.trim().length||"s"==Y||("TRUE"===y?V={t:"b",v:!0}:"FALSE"===y?V={t:"b",v:!1}:isNaN(Tn(y))?isNaN(Ys(y).getDate())||(V={t:"d",v:Or(y)},a.cellDates||(V={t:"n",v:Nr(V.v)}),V.z=a.dateNF||de[14]):V={t:"n",v:Tn(y)})),void 0===V.z&&null!=H&&(V.z=H);var L="",se=M.getElementsByTagName("A");if(se&&se.length)for(var ae=0;ae<se.length&&(!se[ae].hasAttribute("href")||"#"==(L=se[ae].getAttribute("href")).charAt(0));++ae);L&&"#"!=L.charAt(0)&&(V.l={Target:L}),a.dense?(e[x+n]||(e[x+n]=[]),e[x+n][S+i]=V):e[be({c:S+i,r:x+n})]=V,l.e.c<S+i&&(l.e.c=S+i),S+=b}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,x-1+n),e["!ref"]=Ae(l),x>=f&&(e["!fullref"]=Ae((l.e.r=c.length-_+x-1+n,l))),e}function Fc(e,t){return Sc((t||{}).dense?[]:{},e,t)}function yc(e){var t="",r=function Bv(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function Gc(e,t,r,a,n,i,s,c){var f=ur(r),l=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),h=!0,p=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var m=t.s.c;m<=t.e.c;++m){var _=s?e[r][m]:e[a[m]+f];if(void 0!==_&&void 0!==_.t){var x=_.v;switch(_.t){case"z":if(null==x)break;continue;case"e":x=0==x?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(null!=i[m]){if(null==x)if("e"==_.t&&null===x)p[i[m]]=null;else if(void 0!==l)p[i[m]]=l;else{if(!u||null!==x)continue;p[i[m]]=null}else p[i[m]]=u&&("n"!==_.t||"n"===_.t&&!1!==c.rawNumbers)?x:ma(_,x,c);null!=x&&(h=!1)}}else{if(void 0===l)continue;null!=i[m]&&(p[i[m]]=l)}}return{row:p,isempty:h}}function hs(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},a=0,n=1,i=[],s=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=null!=l.range?l.range:e["!ref"];switch(1===l.header?a=1:"A"===l.header?a=2:Array.isArray(l.header)?a=3:null==l.header&&(a=0),typeof u){case"string":f=Pe(u);break;case"number":(f=Pe(e["!ref"])).s.r=u;break;default:f=u}a>0&&(n=0);var h=ur(f.s.r),p=[],m=[],_=0,x=0,T=Array.isArray(e),S=f.s.r,F=0,b={};T&&!e[S]&&(e[S]=[]);var O=l.skipHidden&&e["!cols"]||[],U=l.skipHidden&&e["!rows"]||[];for(F=f.s.c;F<=f.e.c;++F)if(!(O[F]||{}).hidden)switch(p[F]=qe(F),r=T?e[S][F]:e[p[F]+h],a){case 1:i[F]=F-f.s.c;break;case 2:i[F]=p[F];break;case 3:i[F]=l.header[F-f.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),c=s=ma(r,null,l),x=b[s]||0){do{c=s+"_"+x++}while(b[c]);b[s]=x,b[c]=1}else b[s]=1;i[F]=c}for(S=f.s.r+n;S<=f.e.r;++S)if(!(U[S]||{}).hidden){var M=Gc(e,f,S,p,a,i,T,l);(!1===M.isempty||(1===a?!1!==l.blankrows:l.blankrows))&&(m[_++]=M.row)}return m.length=_,m}var jc=/"/g;function $c(e,t,r,a,n,i,s,c){for(var f=!0,l=[],u="",h=ur(r),p=t.s.c;p<=t.e.c;++p)if(a[p]){var m=c.dense?(e[r]||[])[p]:e[a[p]+h];if(null==m)u="";else if(null!=m.v){f=!1,u=""+(c.rawNumbers&&"n"==m.t?m.v:ma(m,null,c));for(var _=0,x=0;_!==u.length;++_)if((x=u.charCodeAt(_))===n||x===i||34===x||c.forceQuotes){u='"'+u.replace(jc,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==m.f||m.F?u="":(f=!1,(u="="+m.f).indexOf(",")>=0&&(u='"'+u.replace(jc,'""')+'"'));l.push(u)}return!1===c.blankrows&&f?null:l.join(s)}function ds(e,t){var r=[],a=t??{};if(null==e||null==e["!ref"])return"";var n=Pe(e["!ref"]),i=void 0!==a.FS?a.FS:",",s=i.charCodeAt(0),c=void 0!==a.RS?a.RS:"\n",f=c.charCodeAt(0),l=new RegExp(("|"==i?"\\|":i)+"+$"),u="",h=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],_=n.s.c;_<=n.e.c;++_)(p[_]||{}).hidden||(h[_]=qe(_));for(var x=0,T=n.s.r;T<=n.e.r;++T)(m[T]||{}).hidden||null!=(u=$c(e,n,T,h,s,f,i,a))&&(a.strip&&(u=u.replace(l,"")),(u||!1!==a.blankrows)&&r.push((x++?c:"")+u));return delete a.dense,r.join("")}function qc(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},s=0,c=0;if(i&&null!=a.origin)if("number"==typeof a.origin)s=a.origin;else{var f="string"==typeof a.origin?tr(a.origin):a.origin;s=f.r,c=f.c}var l,u={s:{c:0,r:0},e:{c,r:s+t.length-1+n}};if(i["!ref"]){var h=Pe(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==s&&(u.e.r=(s=h.e.r+1)+t.length-1+n)}else-1==s&&(s=0,u.e.r=t.length-1+n);var p=a.header||[],m=0;t.forEach(function(x,T){Ke(x).forEach(function(S){-1==(m=p.indexOf(S))&&(p[m=p.length]=S);var F=x[S],b="z",O="",U=be({c:c+m,r:s+T+n});l=rn(i,U),!F||"object"!=typeof F||F instanceof Date?("number"==typeof F?b="n":"boolean"==typeof F?b="b":"string"==typeof F?b="s":F instanceof Date?(b="d",a.cellDates||(b="n",F=Nr(F)),O=a.dateNF||de[14]):null===F&&a.nullError&&(b="e",F=0),l?(l.t=b,l.v=F,delete l.w,delete l.R,O&&(l.z=O)):i[U]=l={t:b,v:F},O&&(l.z=O)):i[U]=F})}),u.e.c=Math.max(u.e.c,c+p.length-1);var _=ur(s);if(n)for(m=0;m<p.length;++m)i[qe(m+c)+_]={t:"s",v:p[m]};return i["!ref"]=Ae(u),i}function rn(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var a=tr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return rn(e,be("number"!=typeof t?t:{r:t,c:r||0}))}function zc(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Yc={encode_col:qe,encode_row:ur,encode_cell:be,encode_range:Ae,decode_col:function R0(e){for(var t=function $l(e){return e.replace(/^\$([A-Z])/,"$1")}(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1},decode_row:function C0(e){return parseInt(function Gl(e){return e.replace(/\$(\d+)$/,"$1")}(e),10)-1},split_cell:function Xl(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:tr,decode_range:rt,format_cell:ma,sheet_add_aoa:N0,sheet_add_json:qc,sheet_add_dom:Sc,aoa_to_sheet:function ql(e,t){return N0(null,e,t)},json_to_sheet:function g2(e,t){return qc(null,e,t)},table_to_sheet:Fc,table_to_book:function Ov(e,t){return function I0(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}(Fc(e,t),t)},sheet_to_csv:ds,sheet_to_txt:function Xc(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=ds(e,t);return r},sheet_to_json:hs,sheet_to_html:function Ac(e,t){var r=t||{},n=null!=r.footer?r.footer:"</body></html>",i=[null!=r.header?r.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>'],s=rt(e["!ref"]);r.dense=Array.isArray(e),i.push(function bc(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}(0,0,r));for(var c=s.s.r;c<=s.e.r;++c)i.push(Tc(e,s,c,r));return i.push("</table>"+n),i.join("")},sheet_to_formulae:function _2(e){var r,t="",a="";if(null==e||null==e["!ref"])return[];var c,n=Pe(e["!ref"]),i="",s=[],f=[],l=Array.isArray(e);for(c=n.s.c;c<=n.e.c;++c)s[c]=qe(c);for(var u=n.s.r;u<=n.e.r;++u)for(i=ur(u),c=n.s.c;c<=n.e.c;++c)if(t=s[c]+i,a="",void 0!==(r=l?(e[u]||[])[c]:e[t])){if(null!=r.F){if(t=r.F,!r.f)continue;a=r.f,-1==t.indexOf(":")&&(t=t+":"+t)}if(null!=r.f)a=r.f;else{if("z"==r.t)continue;if("n"==r.t&&null!=r.v)a=""+r.v;else if("b"==r.t)a=r.v?"TRUE":"FALSE";else if(void 0!==r.w)a="'"+r.w;else{if(void 0===r.v)continue;a="s"==r.t?"'"+r.v:""+r.v}}f[f.length]=t+"="+a}return f},sheet_to_row_object_array:hs,sheet_get_cell:rn,book_new:function xs(){return{SheetNames:[],Sheets:{}}},book_append_sheet:function ps(e,t,r,a){var n=1;if(!r)for(;n<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+n);++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var s=i&&i[1]||r;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(r=s+n);++n);}if(function hc(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return ug.forEach(function(a){if(-1!=e.indexOf(a)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r},book_set_sheet_visibility:function w2(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=function v2(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r},cell_set_number_format:function T2(e,t){return e.z=t,e},cell_set_hyperlink:zc,cell_set_internal_link:function k2(e,t,r){return zc(e,"#"+t,r)},cell_add_comment:function E2(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})},sheet_set_array_formula:function b2(e,t,r,a){for(var n="string"!=typeof t?t:Pe(t),i="string"==typeof t?t:Ae(t),s=n.s.r;s<=n.e.r;++s)for(var c=n.s.c;c<=n.e.c;++c){var f=rn(e,s,c);f.t="n",f.F=i,delete f.v,s==n.s.r&&c==n.s.c&&(f.f=r,a&&(f.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};let C2=(()=>{class e{constructor(r,a,n,i){this.dialogRef=r,this.data=a,this.utilities=n,this.bitacoraService=i,this.bitacora=a.bitacora}guardar(){this.bitacoraService.closedSot(this.bitacora.id).subscribe(r=>{403==r.message?this.utilities.snackBar("Cerrar"):(this.utilities.snackBar("Se Cerro Sot"),this.dialogRef.close())})}static#e=this.\u0275fac=function(a){return new(a||e)(o.Y36(Oe.so),o.Y36(Oe.WI),o.Y36(ba.e),o.Y36(Ce.k))};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-end-sot"]],decls:9,vars:1,consts:[["mat-dialog-title",""],[1,"mat-typography"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(a,n){1&a&&(o.TgZ(0,"h2",0),o._uU(1,"Cierre de SOT"),o.qZA(),o.TgZ(2,"mat-dialog-content",1),o._uU(3),o.qZA(),o.TgZ(4,"mat-dialog-actions",2)(5,"button",3),o._uU(6,"No"),o.qZA(),o.TgZ(7,"button",4),o.NdJ("click",function(){return n.guardar()}),o._uU(8,"Si"),o.qZA()()),2&a&&(o.xp6(3),o.hij(" Esta seguro de Cerrar el SOT de la bitacora ",n.bitacora.nombre,"\n"))},dependencies:[dt.lW,Oe.ZT,Oe.uh,Oe.xY,Oe.H8]})}return e})();var R2=xe(3586),D2=xe(217);let ms;try{ms=!!new Blob}catch{ms=!1}let I2=(()=>{class e{get isFileSaverSupported(){return ms}genType(r){if(!r||-1===r.lastIndexOf("."))return"text/plain";const a=r.substring(r.lastIndexOf(".")+1);switch(a){case"txt":return"text/plain";case"xml":case"html":return`text/${a}`;case"json":return"octet/stream";default:return`application/${a}`}}save(r,a,n,i){if(!r)throw new Error("Data argument should be a blob instance");const s=new Blob([r],{type:n||r.type||this.genType(a)});(0,D2.saveAs)(s,decodeURI(a||"download"),i)}saveText(r,a,n){const i=new Blob([r]);this.save(i,a,void 0,n)}static#e=this.\u0275fac=function(a){return new(a||e)};static#r=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var N2=xe(5159),Jc=xe(3566),Kc=xe(2596);function O2(e,t){1&e&&(o.TgZ(0,"th",53),o._uU(1,"Fecha"),o.qZA())}function B2(e,t){1&e&&(o.TgZ(0,"th",54),o._uU(1,"SOT"),o.qZA())}function P2(e,t){1&e&&(o.TgZ(0,"th"),o._uU(1,"ESTADO SOT"),o.qZA())}function L2(e,t){1&e&&(o.TgZ(0,"th",55),o._uU(1,"Incidencia"),o.qZA())}function M2(e,t){1&e&&(o.TgZ(0,"th",56),o._uU(1,"Tipo Averia"),o.qZA())}function U2(e,t){1&e&&(o.TgZ(0,"th",57),o._uU(1,"Red"),o.qZA())}function Z2(e,t){1&e&&(o.TgZ(0,"th",58),o._uU(1,"Serv"),o.qZA())}function H2(e,t){1&e&&(o.TgZ(0,"th",59),o._uU(1,"Estado Bitacora"),o.qZA())}function W2(e,t){if(1&e&&(o.TgZ(0,"td"),o._uU(1),o.qZA()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.Oqu(r.fecha_inicial)}}function V2(e,t){if(1&e&&(o.TgZ(0,"td"),o._uU(1),o.qZA()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.Oqu(r.sot)}}const Qc=function(e,t){return{"status-red":e,"status-green":t}};function G2(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"button",72),o.NdJ("click",function(){o.CHM(r);const n=o.oxw(2).$implicit,i=o.oxw();return o.KtG(i.inactiva(n))}),o._uU(1),o.qZA()}if(2&e){const r=o.oxw(2).$implicit;o.Q6J("ngClass",o.WLB(3,Qc,!0===r.estado_sot,!1===r.estado_sot))("disabled",!0===r.estado_sot&&"1"===r.estado||!1===r.estado_sot),o.xp6(1),o.hij(" ",r.estado_sot_text," ")}}function j2(e,t){if(1&e&&(o.TgZ(0,"td"),o.YNc(1,G2,2,6,"button",71),o.qZA()),2&e){const r=o.oxw(2);o.xp6(1),o.Q6J("ngIf",!r.esMovil)}}function $2(e,t){if(1&e&&(o.TgZ(0,"td"),o._uU(1),o.qZA()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.Oqu(r.incidencia)}}function X2(e,t){if(1&e&&(o.TgZ(0,"td"),o._uU(1),o.qZA()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.Oqu(r.tipo_averia.nombre)}}function q2(e,t){if(1&e&&(o.TgZ(0,"td"),o._uU(1),o.qZA()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.Oqu(r.red.nombre)}}function z2(e,t){if(1&e&&(o.TgZ(0,"td"),o._uU(1),o.qZA()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.Oqu(r.serv.nombre)}}function Y2(e,t){if(1&e&&(o.TgZ(0,"td")(1,"a",73),o._uU(2),o.qZA()()),2&e){const r=o.oxw().$implicit;o.xp6(1),o.Q6J("ngClass",o.WLB(2,Qc,"1"===r.estado,"0"===r.estado)),o.xp6(1),o.Oqu(r.estadotext)}}const J2=function(e){return["/bitacoras/list-bitacora/detalle-bitacora/",e]},K2=function(e){return["/bitacoras/edit-bitacora/",e]};function Q2(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"tr")(1,"td",60),o._uU(2),o.qZA(),o.YNc(3,W2,2,1,"td",34),o.YNc(4,V2,2,1,"td",34),o.YNc(5,j2,2,1,"td",34),o.YNc(6,$2,2,1,"td",34),o.YNc(7,X2,2,1,"td",34),o.YNc(8,q2,2,1,"td",34),o.YNc(9,z2,2,1,"td",34),o.YNc(10,Y2,3,5,"td",34),o.TgZ(11,"td",61)(12,"button",62),o._UZ(13,"i",63),o.qZA(),o.TgZ(14,"button",64)(15,"i",65),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.openDialogLocation(i))}),o.qZA()(),o.TgZ(16,"button",64)(17,"i",66),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.openDialogEnd(i))}),o.qZA()(),o.TgZ(18,"button",62),o._UZ(19,"i",67),o.qZA(),o.TgZ(20,"button",64)(21,"i",68),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.openDialogDemora(i))}),o.qZA()(),o.TgZ(22,"button",69)(23,"i",70),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.openDialog(i.id))}),o.qZA()()()()}if(2&e){const r=t.$implicit,a=o.oxw();o.xp6(1),o.Q6J("matTooltip",r.nombre),o.xp6(1),o.hij(" ",r.nombre," "),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(1),o.Q6J("ngIf",!a.esMovil),o.xp6(2),o.Q6J("disabled","0"===r.estado)("routerLink",o.VKq(17,J2,r.id)),o.xp6(2),o.Q6J("disabled","0"===r.estado),o.xp6(2),o.Q6J("disabled","0"===r.estado),o.xp6(2),o.Q6J("disabled","0"===r.estado)("routerLink",o.VKq(19,K2,r.id)),o.xp6(2),o.Q6J("disabled",!1===r.estado_sot)}}function ew(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"li",75),o.NdJ("click",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage-2))})("keyup.enter",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage-2))}),o.TgZ(1,"a",76),o._uU(2," ... "),o.qZA()()}if(2&e){const r=o.oxw(2);o.Q6J("hidden",1===r.currentPage)}}function rw(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"li",75),o.NdJ("click",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage+2))})("keyup.enter",function(){o.CHM(r);const n=o.oxw(2);return o.KtG(n.moveToPage(n.currentPage+2))}),o.TgZ(1,"a",76),o._uU(2," ... "),o.qZA()()}if(2&e){const r=o.oxw(2);o.Q6J("hidden",r.currentPage>=r.pageNumberArray[r.pageNumberArray.length-2]||r.totalData<r.serialNumberArray[r.serialNumberArray.length-1])}}function tw(e,t){if(1&e){const r=o.EpF();o.ynx(0),o.TgZ(1,"li",47)(2,"a",49),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw();return o.KtG(s.moveToPage(i))}),o._uU(3),o.qZA()(),o.YNc(4,ew,3,1,"li",74),o.YNc(5,rw,3,1,"li",74),o.BQk()}if(2&e){const r=t.$implicit,a=t.index,n=o.oxw();o.xp6(1),o.ekj("active",r===n.currentPage),o.Q6J("ngClass",n.pageNumberArray[n.currentPage-2]>r&&1!==r&&n.pageNumberArray.length>6||n.pageNumberArray[n.currentPage]<r&&1!==r&&n.pageNumberArray.length>6&&n.pageNumberArray.length!==r?"hide-page-no":"show-page-no"),o.xp6(2),o.hij(" ",r," "),o.xp6(1),o.Q6J("ngIf",0===a&&n.pageNumberArray.length>6&&n.currentPage>2),o.xp6(1),o.Q6J("ngIf",a===n.pageNumberArray.length-2&&n.pageNumberArray.length>6)}}function aw(e,t){if(1&e&&(o._UZ(0,"img",79),o.ALo(1,"async")),2&e){const r=o.oxw(2);o.Q6J("src",o.lcZ(1,1,r.utilities.qrImagen$),o.LSH)}}function nw(e,t){if(1&e&&(o.TgZ(0,"div",77)(1,"h4"),o._uU(2,"Escanea el c\xf3digo QR:"),o.qZA(),o.YNc(3,aw,2,3,"img",78),o.ALo(4,"async"),o.qZA()),2&e){const r=o.oxw();o.xp6(3),o.Q6J("ngIf",o.lcZ(4,1,r.utilities.qrImagen$))}}function iw(e,t){1&e&&(o.TgZ(0,"div",77)(1,"h4"),o._uU(2,"\u2705 Conectado"),o.qZA()())}function sw(e,t){1&e&&(o.TgZ(0,"div")(1,"p",80),o._uU(2,"\u274c Error al conectar"),o.qZA()())}const ef=function(e){return{disabled:e}};let ow=(()=>{class e{constructor(r,a,n,i,s,c,f){this.bitacoraService=r,this.dialog=a,this.auth=n,this.fileSaver=i,this.time_utils=s,this.utilities=c,this.whatsapp=f,this.esMovil=!1,this.detalleBitacora=[],this.bitacoras=[],this.showFilter=!1,this.searchDataValue="",this.lastIndex=0,this.pageSize=10,this.totalData=0,this.skip=0,this.limit=this.pageSize,this.pageIndex=0,this.serialNumberArray=[],this.currentPage=1,this.pageNumberArray=[],this.pageSelection=[],this.totalPages=0,this.bitacora_generals=[],this.qrData=null,this.error=null,this.sessionId="",this.mensaje="",this.gruposTexto="",this.qrImagen$=this.utilities.qrImagen$,this.estado$=this.utilities.estado$}ngOnInit(){this.esMovil=this.utilities.isMobile(),this.user=this.auth.user,this.getTableData();const r=localStorage.getItem("user"),a=r?JSON.parse(r):null;a&&a.name&&(this.sessionId=a.whatsapp)}enviar(r){const a=this.gruposTexto.split(",").map(n=>n.trim()).filter(Boolean);a.length&&this.utilities.enviarMensajeAGrupos(this.sessionId,a,r)}getTableData(r=1){this.serialNumberArray=[],this.bitacoraService.readAll({page:r,search:this.searchDataValue}).subscribe(a=>{console.log(a.total),this.totalData=a.total,this.bitacoras=a.data.map(n=>({...n,estado_sot:!!n.estado_sot})),this.dataSource=new Zt.by(this.bitacoras),this.calculateTotalPages(this.totalData,this.pageSize)})}searchData(){this.pageSelection=[],this.limit=this.pageSize,this.skip=0,this.currentPage=1,this.getTableData()}sortData(r){const a=this.bitacoras.slice();this.bitacoras=r.active&&""!==r.direction?a.sort((n,i)=>(n[r.active]<i[r.active]?-1:1)*("asc"===r.direction?1:-1)):a}getMoreData(r){"next"==r?(this.currentPage++,this.pageIndex=this.currentPage-1,this.limit+=this.pageSize,this.skip=this.pageSize*this.pageIndex,this.getTableData(this.currentPage)):"previous"==r&&(this.currentPage--,this.pageIndex=this.currentPage-1,this.limit-=this.pageSize,this.skip=this.pageSize*this.pageIndex,this.getTableData(this.currentPage))}moveToPage(r){this.currentPage=r,this.skip=this.pageSelection[r-1].skip,this.limit=this.pageSelection[r-1].limit,r>this.currentPage?this.pageIndex=r-1:r<this.currentPage&&(this.pageIndex=r+1),this.getTableData(this.currentPage)}PageSize(){this.pageSelection=[],this.limit=this.pageSize,this.skip=0,this.currentPage=1,this.searchDataValue="",this.getTableData()}calculateTotalPages(r,a){this.pageNumberArray=[],this.totalPages=r/a,this.totalPages%1!=0&&(this.totalPages=Math.trunc(this.totalPages+1));for(var n=1;n<=this.totalPages;n++){const i=a*n,s=i-a;this.pageNumberArray.push(n),this.pageSelection.push({skip:s,limit:i})}}openDialog(r){this.dialog.open(ei,{data:{id:r}})}openDialogEnd(r){r.latitud&&r.longitud?this.dialog.open(Af.a,{data:{bitacora:r}}).afterClosed().subscribe(()=>{this.getTableData(this.currentPage)}):this.utilities.snackBar("La bitacora no puede ser cerrada, no cuenta con latitud y longitud")}openDialogDemora(r){this.dialog.open(Nf,{data:{bitacora:r}})}openDialogLocation(r){this.dialog.open(Sf.D,{data:{bitacora:r}}).afterClosed().subscribe(()=>{this.getTableData(this.currentPage)})}inactiva(r){1==r.estado_sot&&this.dialog.open(C2,{data:{bitacora:r}}).afterClosed().subscribe(()=>{this.getTableData(this.currentPage)})}exportExcel(){this.bitacoraService.exportExcel().subscribe(a=>{this.totalData=a.total,this.detalleBitacora=a.data,console.log(a.data);const n=this.exportDataToExcel(a.data),i=Yc.json_to_sheet(n);["A\xf1o","Mes","Semana","Fecha y Hora Asignaci\xf3n Cliente","Fecha y Hora Ejecucion","Incidencia","SOT","Fecha y Hora se creacion de SOT","Estatus SGA","Tipo de Incidencia","Red Afectada","Causa de Aver\xeda","Agrupamiento de Causa de Aver\xeda","Afectaci\xf3n de Servicio","Afectaci\xf3n Masiva","Base","Zona","SUP. Claro","SUP. Cicsa","Brigada #1 Asignada","Hora Asignaci\xf3n","Horarios por cuadrantes","POP/Site/Nodo","Departamento","Provincia","Distrito del punto de aver\xeda","Region Geografica","Fecha y Hora Llegada al Sitio","SLA Traslado Pop / Cliente2","Fecha y Hora de UBICACION punto de Aver\xeda / Trabajo2","SLA ubicaci\xf3n punto Aver\xeda2","Fecha y Hora UP Aver\xeda / Reparaci\xf3n TUPs","SLA Trabajos preliminares + Prepara. y Fusi\xf3n","SLA TOTAL Aver\xeda / Atenci\xf3n","Cumpli\xf3 SLA","Fecha y Hora de Retiro de la brigada","Tiempo total de atencion de incidencias","DEMORA #1 (cuando no se cumpla con el SLA)","F. y Hora INICIO Demora #1","F. y Hora FIN Demora #1","Tiempo de Demora #1","DEMORA #2 (cuando no se cumpla con el SLA)","F. y Hora INICIO Demora #2","F. y Hora FIN Demora #2","Tiempo de Demora #2","DEMORA #3 (cuando no se cumpla con el SLA)","F. y Hora INICIO Demora #3","F. y Hora FIN Demora #3","Tiempo de Demora #3","Total Demoras"," Coordenadas - Punto Averia LATITUD2"," Coordenadas - Punto Averia LONGITUD","bitacora","Tipo de Trabajo","Prioridad","Observaciones","NOMBRE DE EVENTO O INTERCONEXION"].map((l,u)=>({v:l,t:"s"})).forEach((l,u)=>{const h=this.getExcelColumnName(u);i[`${h}1`]=l});const f=Yc.sheet_to_csv(i);this.saveAsCSVFile(f,"Exportacion.csv")})}getExcelColumnName(r){let a="";for(;r>=0;)a=String.fromCharCode(r%26+65)+a,r=Math.floor(r/26)-1;return a}tiempofinsla(r,a){var n="";return r.forEach(i=>{i.atencion.id===a&&(n=i.hora)}),n}exportDataToExcel(r){return r.map(a=>{let l,n=this.tiempofinsla(a.atenciones,1)||"",i=this.tiempofinsla(a.atenciones,5)||"",s=this.tiempofinsla(a.atenciones,6)||"",c=this.tiempofinsla(a.atenciones,10)||"",f=[];n&&(l={fecha_inicio:a.fecha_ejecucion||"",fecha_fin:n},f.push(l)),n&&i&&(l={fecha_inicio:n,fecha_fin:i},f.push(l)),i&&s&&(l={fecha_inicio:i,fecha_fin:s},f.push(l));let u=n?this.time_utils.calcularDiferenciaTiempo(a.fecha_ejecucion||"",n):"",h=n&&i?this.time_utils.calcularDiferenciaTiempo(n||"",i):"",p=i&&s?this.time_utils.calcularDiferenciaTiempo(i||"",s):"",m="Preventivo"===a.tipo_averia.nombre||"Sinergia"===a.tipo_averia.nombre?""===a.causa_averia?.nombre?"FALSA AVER\xcdA":"NO ES AVERIA":"",_=[];_=a.demoras?.map(F=>({...F,tiempoDemora:this.time_utils.convierteHoras(this.time_utils.calcularDiferenciaTiempo(F.fecha_inicio||"",F.fecha_fin))}))??[];let x=this.time_utils.updateTotalDemoras(_),T=s?this.time_utils.calcularDiferenciaTiempo(a.fecha_inicial||"",s)-x:"",S=c?this.time_utils.calcularDiferenciaTiempo(a.fecha_inicial||"",c)-x:"";return{anio:a.anio,mes:a.mes,semana:a.semana,fecha_inicial:a.fecha_inicial,fecha_ejecucion:a.fecha_ejecucion,nro_incidencia:a.incidencia,nro_sot:a.sot,fecha_sot:a.fecha_sot,status_sot:a.estado_sot,incidencia:a.tipo_averia.incidencia,red_afectada:a.red.nombre,causa_averia:a.causa_averia?.nombre,agru_causa_averia:a.causa_averia?.tipo_causa_averia.nombre||"",afectacion_servicio:a.afect_servicio,afectacion_masiva:a.afect_masiva,base:a.site.zona,zona:a.site.region,sup_claro:a.resp_claro.nombres,sup_cicsa:a.resp_cicsa.nombres,brigada:a.nombre_brigada,hora_asignacion:a.hora_asignacion,horarios_cuadrantes:this.utilities.obtenerCuadrante(a.hora_asignacion||""),site:a.site.nombre,departamento:a.site.departamento?.nombre,provincia:a.site.provincia?.nombre,distrito:a.site.distrito?.nombre,region_geografica:a.site.region_geografica?.nombre,fecha_llegada:n,sla_llegada:"Correctivo"===a.tipo_averia.nombre?this.time_utils.convierteHoras(u):m,fecha_ubica_punto:i,sla_ubica_punto:"Correctivo"===a.tipo_averia.nombre?this.time_utils.convierteHoras(h):m,fecha_fusion:s,sla_fusion:"Correctivo"===a.tipo_averia.nombre?this.time_utils.convierteHoras(p):m,sla_total:"Correctivo"===a.tipo_averia.nombre?this.time_utils.convierteHoras(T):m,sla_cumplio:"",retiro:c,sla_tiempo_total:"Correctivo"===a.tipo_averia.nombre?this.time_utils.convierteHoras(S):m,demora_1:_[0]?.demora_nombre?_[0].demora_nombre:"",inicio_demora_1:_[0]?.fecha_inicio?_[0].fecha_inicio:"",fin_demora_1:_[0]?.fecha_fin?_[0].fecha_fin:"",tiempo_demora_1:_[0]?.tiempoDemora?_[0].tiempoDemora:"",demora_2:_[1]?.demora_nombre?_[1].demora_nombre:"",inicio_demora_2:_[1]?.fecha_inicio?_[1].fecha_inicio:"",fin_demora_2:_[1]?.fecha_fin?_[1].fecha_fin:"",tiempo_demora_2:_[1]?.tiempoDemora?_[1].tiempoDemora:"",demora_3:_[2]?.demora_nombre?_[2].demora_nombre:"",inicio_demora_3:_[2]?.fecha_inicio?_[2].fecha_inicio:"",fin_demora_3:_[2]?.fecha_fin?_[2].fecha_fin:"",tiempo_demora_3:_[2]?.tiempoDemora?_[2].tiempoDemora:"",total_demoras:a.demoras?this.time_utils.convierteHoras(x):"",latitud:a.latitud,longitud:a.longitud,bitacora:this.utilities.armaBitacora(a),Tipo_trabajo:a.tipo_reparacion?.nombre?a.tipo_reparacion.nombre:"",prioridad:"",Observacion:"",nombre_bitacora:a.nombre,enlace:a.enlace_plano_site}})}saveAsExcelFile(r,a){const n=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});this.fileSaver.save(n,a+".xlsx")}saveAsCSVFile(r,a){const n=new Blob([r],{type:"text/csv;charset=UTF-8"});this.fileSaver.save(n,a)}static#e=this.\u0275fac=function(a){return new(a||e)(o.Y36(Ce.k),o.Y36(Oe.uw),o.Y36(R2.e),o.Y36(I2),o.Y36(un),o.Y36(ba.e),o.Y36(N2.C))};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-list-bitacoras"]],decls:78,vars:29,consts:[[1,"page-wrapper"],[1,"content"],[1,"page-header"],[1,"row"],[1,"col-sm-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"feather","icon-chevron-right"],[1,"breadcrumb-item","active"],[1,"card","card-table","show-entire"],[1,"card-body"],[1,"page-table-header","mb-2"],[1,"row","align-items-center"],[1,"col"],[1,"doctor-table-blk"],[1,"doctor-search-blk"],[1,"top-nav-search","table-search-blk"],["placeholder","Search here",1,"form-control",3,"ngModel","ngModelChange","keyup.enter"],[1,"btn"],["src","assets/img/icons/search-normal.svg","alt",""],[1,"add-group"],["routerLink","/bitacoras/add-bitacora",1,"btn","btn-primary","add-pluss","ms-2"],["src","assets/img/icons/plus.svg","alt",""],["href","javascript:;",1,"btn","btn-primary","doctor-refresh","ms-2",3,"click"],["src","assets/img/icons/re-fresh.svg","alt",""],[1,"col-auto","text-end","float-end","ms-auto","download-grp"],["href","javascript:;",1,"me-2",3,"click"],["src","assets/img/icons/pdf-icon-03.svg","alt",""],[1,"table-responsive"],["matSort","",1,"table","border-0","custom-table","comman-table","datatable","mb-0",3,"matSortChange"],["mat-sort-header","nombre",1,"col-sm-4"],["mat-sort-header","fecha_inicial",4,"ngIf"],["mat-sort-header","sot",4,"ngIf"],[4,"ngIf"],["mat-sort-header","incidencia",4,"ngIf"],["mat-sort-header","tipo_averia",4,"ngIf"],["mat-sort-header","red",4,"ngIf"],["mat-sort-header","serv",4,"ngIf"],["mat-sort-header","estado",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"table_footer"],[1,"col-sm-12","col-md-5"],[1,"dataTables_info"],[1,"col-sm-12","col-md-7"],[1,"pagination_section","mx-2"],[1,"pagination"],[1,"page-item",3,"ngClass"],["href","javascript:void(0);","tabindex","-1",1,"page-link",3,"click"],["href","javascript:void(0);",1,"page-link",3,"click"],[1,"container","mt-3","text-center"],[1,"container",2,"text-align","center"],["style","margin-top: 20px;",4,"ngIf"],["mat-sort-header","fecha_inicial"],["mat-sort-header","sot"],["mat-sort-header","incidencia"],["mat-sort-header","tipo_averia"],["mat-sort-header","red"],["mat-sort-header","serv"],["mat-sort-header","estado"],[2,"max-width","24rem","text-overflow","ellipsis","white-space","nowrap","overflow","hidden",3,"matTooltip"],[1,"text-end"],[1,"btn","btn-primary","ms-1",3,"disabled","routerLink"],[1,"fa","fa-clock"],[1,"btn","btn-primary","ms-1",3,"disabled"],["aria-hidden","true",1,"fas","fa-map-marker-alt",3,"click"],["aria-hidden","true",1,"fa","fa-check",3,"click"],[1,"fa","fa-pencil"],["aria-hidden","true",1,"fa","fa-hourglass",3,"click"],[1,"btn","btn-primary","ms-1"],["aria-hidden","true",1,"fa","fa-eye",3,"click"],["class","custom-badge",3,"ngClass","disabled","click",4,"ngIf"],[1,"custom-badge",3,"ngClass","disabled","click"],[1,"custom-badge",3,"ngClass"],["class","page-item","tabindex","0",3,"hidden","click","keyup.enter",4,"ngIf"],["tabindex","0",1,"page-item",3,"hidden","click","keyup.enter"],["href","javascript:void(0);",1,"page-link"],[2,"margin-top","20px"],["width","300",3,"src",4,"ngIf"],["width","300",3,"src"],[2,"color","red"]],template:function(a,n){1&a&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),o._uU(8,"Bitacoras "),o.qZA()(),o.TgZ(9,"li",6),o._UZ(10,"i",8),o.qZA(),o.TgZ(11,"li",9),o._uU(12,"Lista de Bitacoras"),o.qZA()()()()(),o.TgZ(13,"div",3)(14,"div",4)(15,"div",10)(16,"div",11)(17,"div",12)(18,"div",13)(19,"div",14)(20,"div",15)(21,"h3"),o._uU(22,"Listado de Bitacoras"),o.qZA(),o.TgZ(23,"div",16)(24,"div",17)(25,"input",18),o.NdJ("ngModelChange",function(s){return n.searchDataValue=s})("keyup.enter",function(){return n.searchData()}),o.qZA(),o.TgZ(26,"a",19),o._UZ(27,"img",20),o.qZA()(),o.TgZ(28,"div",21)(29,"a",22),o._UZ(30,"img",23),o.qZA(),o.TgZ(31,"a",24),o.NdJ("click",function(){return n.PageSize()}),o._UZ(32,"img",25),o.qZA()()()()(),o.TgZ(33,"div",26)(34,"a",27),o.NdJ("click",function(){return n.exportExcel()}),o._UZ(35,"img",28),o.qZA()()(),o.TgZ(36,"div",29)(37,"table",30),o.NdJ("matSortChange",function(s){return n.sortData(s)}),o.TgZ(38,"thead")(39,"tr")(40,"th",31),o._uU(41,"Nombre"),o.qZA(),o.YNc(42,O2,2,0,"th",32),o.YNc(43,B2,2,0,"th",33),o.YNc(44,P2,2,0,"th",34),o.YNc(45,L2,2,0,"th",35),o.YNc(46,M2,2,0,"th",36),o.YNc(47,U2,2,0,"th",37),o.YNc(48,Z2,2,0,"th",38),o.YNc(49,H2,2,0,"th",39),o.TgZ(50,"th"),o._uU(51,"Acci\xf3n"),o.qZA()()(),o.TgZ(52,"tbody"),o.YNc(53,Q2,24,21,"tr",40),o.qZA()(),o.TgZ(54,"div",41)(55,"div",42)(56,"div",43),o._uU(57),o.qZA()(),o.TgZ(58,"div",44)(59,"div",45)(60,"ul",46)(61,"li",47)(62,"a",48),o.NdJ("click",function(){return n.getMoreData("previous")}),o._uU(63,"Anterior"),o.qZA()(),o.YNc(64,tw,6,6,"ng-container",40),o.TgZ(65,"li",47)(66,"a",49),o.NdJ("click",function(){return n.getMoreData("next")}),o._uU(67,"Siguiente "),o.qZA()()()()()()()()()()()(),o.TgZ(68,"div",50)(69,"div",51)(70,"h2"),o._uU(71,"Conectar a WhatsApp"),o.qZA(),o.YNc(72,nw,5,3,"div",52),o.ALo(73,"async"),o.YNc(74,iw,3,0,"div",52),o.ALo(75,"async"),o.YNc(76,sw,3,0,"div",34),o.ALo(77,"async"),o.qZA()()()()),2&a&&(o.xp6(25),o.Q6J("ngModel",n.searchDataValue),o.xp6(17),o.Q6J("ngIf",!n.esMovil),o.xp6(1),o.Q6J("ngIf",!n.esMovil),o.xp6(1),o.Q6J("ngIf",!n.esMovil),o.xp6(1),o.Q6J("ngIf",!n.esMovil),o.xp6(1),o.Q6J("ngIf",!n.esMovil),o.xp6(1),o.Q6J("ngIf",!n.esMovil),o.xp6(1),o.Q6J("ngIf",!n.esMovil),o.xp6(1),o.Q6J("ngIf",!n.esMovil),o.xp6(4),o.Q6J("ngForOf",n.bitacoras),o.xp6(4),o.lnq(" Mostrando ",n.serialNumberArray[0]," a ",n.serialNumberArray[n.serialNumberArray.length-1]," de ",n.totalData," bitacoras "),o.xp6(4),o.Q6J("ngClass",o.VKq(25,ef,1===n.currentPage)),o.xp6(3),o.Q6J("ngForOf",n.pageNumberArray),o.xp6(1),o.Q6J("ngClass",o.VKq(27,ef,n.currentPage===n.pageNumberArray[n.pageNumberArray.length-1]||0===n.bitacoras.length)),o.xp6(7),o.Q6J("ngIf","esperando_qr"===o.lcZ(73,19,n.utilities.estado$)),o.xp6(2),o.Q6J("ngIf","conectado"===o.lcZ(75,21,n.utilities.estado$)),o.xp6(2),o.Q6J("ngIf","error"===o.lcZ(77,23,n.utilities.estado$)))},dependencies:[Je.mk,Je.sg,Je.O5,Ir.rH,ue.Fj,ue.JJ,ue.On,Jc.YE,Jc.nU,Kc.gM,Je.Ov],styles:["section[_ngcontent-%COMP%]{display:table}.example-label[_ngcontent-%COMP%]{display:table-cell;font-size:14px;margin-left:8px;min-width:120px}.example-button-row[_ngcontent-%COMP%]{display:table-cell;max-width:600px}.example-button-row[_ngcontent-%COMP%]   .mat-mdc-button-base[_ngcontent-%COMP%]{margin:8px 8px 8px 0}.example-flex-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap}.example-button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;width:120px}"]})}return e})();var _s=xe(5195);function cw(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"a")(1,"i",19),o.NdJ("click",function(){o.CHM(r);const n=o.oxw().$implicit,i=o.oxw();return o.KtG(i.addItemAtencion(n))}),o.qZA()()}}function fw(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"button",31),o.NdJ("click",function(){o.CHM(r);const n=o.oxw().index,i=o.oxw().$implicit,s=o.oxw();return o.KtG(s.deleteItem(i,n))}),o._UZ(1,"i",32),o.qZA()}}const zn=function(){return{standalone:!0}};function lw(e,t){if(1&e){const r=o.EpF();o.TgZ(0,"div",35)(1,"div",22),o._UZ(2,"label",23),o.TgZ(3,"input",24),o.NdJ("ngModelChange",function(n){o.CHM(r);const i=o.oxw().$implicit;return o.KtG(i.hora=n)}),o.qZA()()()}if(2&e){const r=o.oxw().$implicit;o.xp6(2),o.Q6J("for",r.hora),o.xp6(1),o.Q6J("name",r.hora)("ngModel",r.hora)("ngModelOptions",o.DdM(4,zn))}}function uw(e,t){if(1&e){const r=o.EpF();o.ynx(0),o.TgZ(1,"div",20),o.YNc(2,lw,4,5,"div",33),o.TgZ(3,"div",34)(4,"div",22),o._UZ(5,"label",23),o.TgZ(6,"textarea",26),o.NdJ("ngModelChange",function(n){const s=o.CHM(r).$implicit;return o.KtG(s.descripcion=n)}),o.qZA()()(),o.TgZ(7,"div",21)(8,"button",28)(9,"i",29),o.NdJ("click",function(){o.CHM(r);const n=o.oxw().$implicit,i=o.oxw(2);return o.KtG(i.addItem(n,"1"))}),o.qZA()(),o.TgZ(10,"button",28)(11,"i",19),o.NdJ("click",function(){o.CHM(r);const n=o.oxw().$implicit,i=o.oxw(2);return o.KtG(i.addItem(n,"0"))}),o.qZA()(),o.TgZ(12,"button",31),o.NdJ("click",function(){const i=o.CHM(r).index,s=o.oxw().$implicit,c=o.oxw(2);return o.KtG(c.deleteItemHijo(s,i))}),o._UZ(13,"i",32),o.qZA()()(),o.BQk()}if(2&e){const r=t.$implicit,a=o.oxw().$implicit,n=o.oxw(2);o.xp6(2),o.Q6J("ngIf","0"===r.is_coment),o.xp6(1),o.ekj("col-xl-7","0"===r.is_coment)("col-xl-9","1"===r.is_coment)("col-md-6","0"===r.is_coment)("col-md-8","1"===r.is_coment)("offset-xl-1","1"===r.is_coment)("offset-md-1","1"===r.is_coment),o.xp6(2),o.Q6J("for",r.descripcion),o.xp6(1),o.Q6J("name",r.descripcion)("ngModel",r.descripcion)("ngModelOptions",o.DdM(19,zn)),o.xp6(2),o.Q6J("disabled",!n.valida(a)),o.xp6(2),o.Q6J("disabled",!n.valida(a))}}function hw(e,t){if(1&e){const r=o.EpF();o.ynx(0),o.TgZ(1,"div",20)(2,"div",21)(3,"div",22),o._UZ(4,"label",23),o.TgZ(5,"input",24),o.NdJ("ngModelChange",function(n){const s=o.CHM(r).$implicit;return o.KtG(s.hora=n)}),o.qZA()()(),o.TgZ(6,"div",25)(7,"div",22),o._UZ(8,"label",23),o.TgZ(9,"textarea",26),o.NdJ("ngModelChange",function(n){const s=o.CHM(r).$implicit;return o.KtG(s.descripcion=n)}),o.qZA()()(),o.TgZ(10,"div",27)(11,"button",28)(12,"i",29),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw(2);return o.KtG(s.addItem(i,"1"))}),o.qZA()(),o.TgZ(13,"button",28)(14,"i",19),o.NdJ("click",function(){const i=o.CHM(r).$implicit,s=o.oxw(2);return o.KtG(s.addItem(i,"0"))}),o.qZA()(),o.YNc(15,fw,2,0,"button",30),o.qZA()(),o.YNc(16,uw,14,20,"ng-container",14),o.BQk()}if(2&e){const r=t.$implicit;o.xp6(4),o.Q6J("for",r.hora),o.xp6(1),o.Q6J("name",r.hora)("ngModel",r.hora)("ngModelOptions",o.DdM(12,zn)),o.xp6(3),o.Q6J("for",r.descripcion),o.xp6(1),o.Q6J("name",r.descripcion)("ngModel",r.descripcion)("ngModelOptions",o.DdM(13,zn)),o.xp6(2),o.Q6J("disabled",!(""!==r.descripcion&&""!==r.hora)),o.xp6(2),o.Q6J("disabled",!(""!==r.descripcion&&""!==r.hora)),o.xp6(2),o.Q6J("ngIf",0===(null==r.bitacora_atencion?null:r.bitacora_atencion.length)),o.xp6(1),o.Q6J("ngForOf",r.bitacora_atencion)}}function dw(e,t){if(1&e&&(o.ynx(0),o.TgZ(1,"mat-card-header")(2,"mat-card-title"),o._uU(3),o.YNc(4,cw,2,0,"a",18),o.qZA()(),o.TgZ(5,"mat-card-content"),o.YNc(6,hw,17,14,"ng-container",14),o.qZA(),o.BQk()),2&e){const r=t.$implicit;o.xp6(3),o.AsE(" (",r.orden,") ",r.descripcion," "),o.xp6(1),o.Q6J("ngIf",0===(null==r.bitacora_atencion?null:r.bitacora_atencion.length)),o.xp6(2),o.Q6J("ngForOf",r.bitacora_atencion)}}const xw=[{path:"",component:Ut,children:[{path:"list-bitacora",component:ow},{path:"add-bitacora",component:Qn},{path:"edit-bitacora",component:Qn},{path:"view-bitacora",component:ei},{path:"edit-bitacora/:id",component:Qn},{path:"view-bitacora",component:ei},{path:"list-bitacora/detalle-bitacora/:bitacora",component:(()=>{class e{constructor(r,a,n,i,s,c){this.bitacorasServices=r,this.activeRoute=a,this._snackBar=n,this.router=i,this.time_utils=s,this.utilities=c,this.itemDetails=[0],this.atenciones=[],this.bitacora_id=0}ngOnInit(){this.activeRoute.params.subscribe(r=>{this.bitacora_id=r.bitacora}),this.bitacorasServices.listAtencion(this.bitacora_id).subscribe(r=>{console.log(r.data),this.atenciones=r.data})}addItemAtencion(r){const a=this.time_utils.getLocalDateTime();0==r.bitacora_atencion.length&&r.bitacora_atencion?.push({id:0,hora:a,descripcion:"",orden:r.orden,is_coment:"0",atencion_id:r.id,bitacora_id:this.bitacora_id,parent_id:0,bitacora_atencion:[]})}valida(r){return"0"==r.bitacora_atencion.at(-1)?.is_coment?""!=r.bitacora_atencion.at(-1)?.descripcion&&""!=r.bitacora_atencion.at(-1)?.hora:""!=r.bitacora_atencion.at(-1)?.descripcion}addItem(r,a){const n=this.time_utils.getLocalDateTime();this.valida(r)?r.bitacora_atencion?.push({id:0,hora:n,descripcion:"",is_coment:a,orden:r.bitacora_atencion.length+1,atencion_id:r.atencion_id,bitacora_id:r.bitacora_id,parent_id:r.atencion_id,bitacora_atencion:[]}):this.snackBar("Falta completar datos")}deleteItemHijo(r,a){r.bitacora_atencion?.splice(a,1),r.bitacora_atencion?.forEach((n,i)=>n.orden=i+1)}deleteItem(r,a){r.bitacora_atencion.splice(a,1)}guardar(){console.log(this.atenciones);const r=new FormData;r.append("id",""+this.bitacora_id),r.append("atenciones",JSON.stringify(this.atenciones)),this.bitacorasServices.createAtencionBitacora(r).subscribe(a=>{console.log(a),403==a.message?this.snackBar("Falta ingresar datos"):(this.snackBar("Registro Exitoso"),this.router.navigate(["/bitacoras/list-bitacora"]))})}cancel(){this.router.navigate(["/bitacoras/list-bitacora"])}snackBar(r){this._snackBar.open(r,"Cerrar",{horizontalPosition:"right",verticalPosition:"top",duration:3e3})}static#e=this.\u0275fac=function(a){return new(a||e)(o.Y36(Ce.k),o.Y36(Ir.gz),o.Y36(At.ux),o.Y36(Ir.F0),o.Y36(un),o.Y36(ba.e))};static#r=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-add-detalle-bitacoras"]],decls:30,vars:1,consts:[[1,"page-wrapper"],[1,"content"],[1,"page-header"],[1,"row"],[1,"col-sm-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"feather","icon-chevron-right"],[1,"breadcrumb-item","active"],[1,"card"],[1,"card-body"],[1,"col-12"],[1,"form-heading"],[4,"ngFor","ngForOf"],[1,"doctor-submit","text-end"],["type","button",1,"btn","btn-primary","submit-form","me-2",3,"click"],["type","submit",1,"btn","btn-primary","cancel-form",3,"click"],[4,"ngIf"],["aria-hidden","true",1,"fas","fa-plus-circle",3,"click"],[1,"row","align-items-center"],[1,"col-12","col-md-3","col-xl-2",2,"height","50px"],[1,"form-group","local-forms"],[3,"for"],["type","datetime-local",1,"form-control",3,"name","ngModel","ngModelOptions","ngModelChange"],[1,"col-12","col-md-6","col-xl-8",2,"height","50px"],["rows","1","cols","10",1,"form-control",3,"name","ngModel","ngModelOptions","ngModelChange"],[1,"col-12","col-md-3","col-xl-2","space-x-4","flex",2,"height","50px"],[1,"btn","btn-primary","ms-1",3,"disabled"],["aria-hidden","true",1,"fa-solid","fa-comment",3,"click"],["class","btn btn-primary ms-1","aria-hidden","true",3,"click",4,"ngIf"],["aria-hidden","true",1,"btn","btn-primary","ms-1",3,"click"],[1,"fas","fa-trash-alt"],["class","col-12 col-md-2 col-xl-2 offset-md-1 offset-xl-1","style","height: 50px;",4,"ngIf"],[1,"col-12",2,"height","50px"],[1,"col-12","col-md-2","col-xl-2","offset-md-1","offset-xl-1",2,"height","50px"]],template:function(a,n){1&a&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),o._uU(8,"Bitacoras"),o.qZA()(),o.TgZ(9,"li",6),o._UZ(10,"i",8),o.qZA(),o.TgZ(11,"li",9),o._uU(12,"Agregar Tareas Bitacora"),o.qZA()()()()(),o.TgZ(13,"div",3)(14,"div",4)(15,"div",10)(16,"div",11)(17,"form")(18,"div",3)(19,"div",12)(20,"div",13)(21,"h4"),o._uU(22,"Desarrollo de la atenci\xf3n de averia : "),o.qZA()()(),o.YNc(23,dw,7,4,"ng-container",14),o.TgZ(24,"div",12)(25,"div",15)(26,"button",16),o.NdJ("click",function(){return n.guardar()}),o._uU(27,"Guardar"),o.qZA(),o.TgZ(28,"button",17),o.NdJ("click",function(){return n.cancel()}),o._uU(29,"Cancel"),o.qZA()()()()()()()()()()()),2&a&&(o.xp6(23),o.Q6J("ngForOf",n.atenciones))},dependencies:[Je.sg,Je.O5,_s.dn,_s.dk,_s.n5,ue._Y,ue.Fj,ue.JJ,ue.JL,ue.On,ue.F]})}return e})()}]}];let pw=(()=>{class e{static#e=this.\u0275fac=function(a){return new(a||e)};static#r=this.\u0275mod=o.oAB({type:e});static#t=this.\u0275inj=o.cJS({imports:[Ir.Bz.forChild(xw),Ir.Bz]})}return e})();var mw=xe(15),_w=xe(9862),gw=xe(3414);let vw=(()=>{class e{static#e=this.\u0275fac=function(a){return new(a||e)};static#r=this.\u0275mod=o.oAB({type:e});static#t=this.\u0275inj=o.cJS({imports:[Je.ez,pw,mw.m,gw.q,ue.u5,ue.UX,_w.JF,Ir.Bz,Kc.AV]})}return e})()},217:function(Jn,cn){var xe,Ir;void 0!==(Ir="function"==typeof(xe=function(){"use strict";function Ut(ye,De,Lr){var Ce=new XMLHttpRequest;Ce.open("GET",ye),Ce.responseType="blob",Ce.onload=function(){oa(Ce.response,De,Lr)},Ce.onerror=function(){console.error("could not download file")},Ce.send()}function ue(ye){var De=new XMLHttpRequest;De.open("HEAD",ye,!1);try{De.send()}catch{}return 200<=De.status&&299>=De.status}function Zt(ye){try{ye.dispatchEvent(new MouseEvent("click"))}catch{var De=document.createEvent("MouseEvents");De.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),ye.dispatchEvent(De)}}var Gr="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,fn=Gr.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),oa=Gr.saveAs||("object"!=typeof window||window!==Gr?function(){}:"download"in HTMLAnchorElement.prototype&&!fn?function(ye,De,Lr){var Ce=Gr.URL||Gr.webkitURL,yr=document.createElement("a");yr.download=De=De||ye.name||"download",yr.rel="noopener","string"==typeof ye?(yr.href=ye,yr.origin===location.origin?Zt(yr):ue(yr.href)?Ut(ye,De,Lr):Zt(yr,yr.target="_blank")):(yr.href=Ce.createObjectURL(ye),setTimeout(function(){Ce.revokeObjectURL(yr.href)},4e4),setTimeout(function(){Zt(yr)},0))}:"msSaveOrOpenBlob"in navigator?function(ye,De,Lr){if(De=De||ye.name||"download","string"!=typeof ye)navigator.msSaveOrOpenBlob(function o(ye,De){return typeof De>"u"?De={autoBom:!1}:"object"!=typeof De&&(console.warn("Deprecated: Expected third argument to be a object"),De={autoBom:!De}),De.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(ye.type)?new Blob(["\ufeff",ye],{type:ye.type}):ye}(ye,Lr),De);else if(ue(ye))Ut(ye,De,Lr);else{var Ce=document.createElement("a");Ce.href=ye,Ce.target="_blank",setTimeout(function(){Zt(Ce)})}}:function(ye,De,Lr,Ce){if((Ce=Ce||open("","_blank"))&&(Ce.document.title=Ce.document.body.innerText="downloading..."),"string"==typeof ye)return Ut(ye,De,Lr);var yr="application/octet-stream"===ye.type,Kn=/constructor/i.test(Gr.HTMLElement)||Gr.safari,ln=/CriOS\/[\d]+/.test(navigator.userAgent);if((ln||yr&&Kn||fn)&&typeof FileReader<"u"){var At=new FileReader;At.onloadend=function(){var Ht=At.result;Ht=ln?Ht:Ht.replace(/^data:[^;]*;/,"data:attachment/file;"),Ce?Ce.location.href=Ht:location=Ht,Ce=null},At.readAsDataURL(ye)}else{var Oe=Gr.URL||Gr.webkitURL,dt=Oe.createObjectURL(ye);Ce?Ce.location=dt:location.href=dt,Ce=null,setTimeout(function(){Oe.revokeObjectURL(dt)},4e4)}});Gr.saveAs=oa.saveAs=oa,Jn.exports=oa})?xe.apply(cn,[]):xe)&&(Jn.exports=Ir)}}]);